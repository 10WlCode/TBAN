function login(n){var t=location.href;return n&&t.indexOf("#"+n)<0&&(t+="#"+n),location.href="//passport.cnblogs"+getHostPostfix()+"/user/signin?ReturnUrl="+encodeURIComponent(t),!1}function logout(){return confirm("确认退出吗？")&&(location.href="//passport.cnblogs"+getHostPostfix()+"/logout.aspx?ReturnUrl="+location.href),!1}function register(){return location.href="http://passport.cnblogs"+getHostPostfix()+"/register.aspx?ReturnUrl="+location.href,!1}function getHostPostfix(){var n=location.hostname;return n.substring(n.lastIndexOf("."),n.length)}function open_new_window(n,t,i,r){document.domain="cnblogs."+location.hostname.substring(location.hostname.lastIndexOf(".")+1,location.hostname.length);var u=(screen.width-t)/2-r,f=(screen.height-i)/2-r,e=window.open(n,"uploadImage","width="+t+",height="+i+",toolbars=0,resizable=1,left="+u+",top="+f);e.focus()}function markdown_image_upload(n){var t="https://upload.cnblogs"+location.hostname.substring(location.hostname.lastIndexOf("."))+"/imageuploader/upload?host=q.cnblogs.com&editor=4#"+n;open_new_window(t,450,120,200)}function checkfeed(){$.ajax({url:"/list/GetUnReadFeedCount",type:"POST",dataType:"Text",success:function(n){parseInt(n)>0?showlayer(n):parseInt(n)===0&&clearlayer()},error:function(n){console.log(n)}});CheckMsg()}function showlayer(n){var i=document.body.clientWidth/2-84,t;$("#qesfeedtip").remove();t='<div id="qesfeedtip" style="text-align:center;"><span style="color:#666;">您有 '+n+' 条新消息，<\/span><a href="http://q.cnblogs.com/list/inbox">查看消息<\/a><\/div>';$("body").append(t);$("#qesfeedtip").css({top:"30px",left:i+"px",border:"1px solid #EEE",padding:"5px 10px",position:"absolute"}).show("fast")}function clearlayer(){$("#qesfeedtip").remove()}function CheckMsg(){$("#msg_count")!==""&&$.ajax({url:"/common/GetUnReadMsgCount",data:"{}",type:"post",dataType:"text",contentType:"application/json; charset=utf-8",cache:!1,success:function(n){parseInt(n)>0?$("#msg_count").html("["+n+"]"):$("#msg_count").html("")}})}function tagRemoveEvent(){$("#interestTag a span").each(function(n,t){$(t).bind("click",function(n){var i=$(t).parent().html().replace(/<.*?>/g,"");$(t).parent().remove();n.preventDefault();deleteInterestTag(i)})})}function getActiveTag(){$.ajax({type:"GET",contentType:"application/json",url:"/tag/GetActiveTag",data:"",dataType:"text",success:function(n){if(n.length>0&&(activeTag=eval(n),$("#interestTag a").each(function(n,t){var i=$(t).text();activeTag=deleteFromArray(activeTag,i)}),!$.browser.msie))$("#inputTagName").on("input",function(){autoInput(activeTag)})}})}function addIntTag(){var n=$.trim($("#inputTagName").val()),t,i;if(n=="")return $("#inputTagName").focus(),!1;t=$("#interestTag a").length+1;i='<a href="/tag/'+encodeURIComponent(n)+'/unsolved" class="detail_tag">'+n+"<span id=interest_tag_"+t+' class="delete-tag" title="移除此Tag"><\/span><\/a>';$("#interestTag").append(i);$("#interest_tag_"+t).click(function(n){$("#interest_tag_"+t).parent().remove();n.preventDefault()});activeTag=deleteFromArray(activeTag,n);$("#inputTagName").val("").focus();addInterestTag()}function addInterestTag(){var n={};n.tags=$("#interestTag a:first").text();$("#interestTag a").each(function(t,i){t>0&&(n.tags+=","+$(i).text())});n.tags=encodeURIComponent(n.tags);$.ajax({type:"POST",contentType:"application/x-www-form-urlencoded; charset=UTF-8",url:"/list/AddInterestTag",data:n,dataType:"text",success:function(n){n.length>0}})}function deleteInterestTag(n){var t={};t.tags=n;t.tags=encodeURIComponent(t.tags);$.ajax({type:"POST",contentType:"application/x-www-form-urlencoded; charset=UTF-8",url:"/list/DeleteInterestTag",data:t,dataType:"text",success:function(n){n.length>0}})}function deleteFromArray(n,t){for(var i in n)n[i].toLowerCase()==t.toLowerCase()&&delete n[i];return n}function autoInput(n){var r=$("#inputTagName"),u="",f=NaN,e,t;r.addClass("search_target");var i=$.trim($("#inputTagName").val().toLowerCase()),s=i.slice(u.length),o=[];if(i=="")return $("#suggest_list").html(""),!1;if(f!==i){for(e in n)if(n[e].indexOf(s)===0&&o.push('<li><a href="javascript:void(0)" data-value="'+u+n[e]+'">'+i+"<b>"+(u+n[e]).slice(i.length)+"<\/b><\/a><\/li>")==20)break;$("#suggest_list").html(o.join(""));i||(f=u=o=[]);$("#suggest_list li").each(function(n,i){$(i).click(function(){t=-1;r.val($(i).text());$("#suggest_list").html("")})});t=-1;$(document).keyup(function(n){var u,i,e;/search_target/i.test(n.target.className)&&(u=0,n.which===38||n.which===104?u--:(n.which===40||n.which===98)&&u++,u&&(i=$("#suggest_list a"),i.removeClass("glow_suggest"),t+=u,t==-2&&(t=i.length-1),t<0&&-t==i.length-1&&(t=i.length),t===i.length&&(t=0),e=i.eq(t).addClass("glow_suggest"),f=e.attr("data-value"),r.val(f),t==-1&&(t=i.length-1)))});r.keyup(function(n){r.valueOf()&&(n.which==13||n.which==108)&&(t=-1,$("#suggest_list").html(""))})}}function getHotTag(){$.get("/tag/hottag",function(n){$("#right_hotcate").after(n)},"html")}function getMyHotTag(){$.get("/tag/myhottag/tag",function(n){$("#right_hotcate").after(n)},"html")}function getWeekExpert(){$.ajax({url:"/list/Weekexpert",type:"get",dataType:"html",success:function(n){$("#right_weekexpert").after(n)}})}function getMyRank(){$.ajax({url:"/u/myrank",type:"get",cache:!1,dataType:"html",success:function(n){$("#right_myrank").after(n)}})}function getMyWealthRank(){$.ajax({url:"/u/mywealthrank",type:"get",dataType:"html",success:function(n){$("#right_myrank").after(n)}})}function getBulletin(){$.get("/list/bulletin",function(n){$("#right_bulletin").after(n)},"html")}function bindask(n){n==undefined&&(n="img_ask");$("#"+n).mouseover(function(){$(this).attr("src","/Images/askqesbg_h.png")}).mouseout(function(){$(this).attr("src","/Images/askqesbg.png")})}function cnblogs_code_collapse(n){n.children("div.cnblogs_code_open").css("display")!="none"?(n.children("div.cnblogs_code_open").css("display","none"),n.children("img.code_img_opened").css("display","none"),n.children("img.code_img_closed").css("display","inline")):(n.children("div.cnblogs_code_open").css("display","block"),n.children("img.code_img_opened").css("display","inline"),n.children("img.code_img_closed").css("display","none"))}function cnblogs_code_show(n){var t=$("#cnblogs_code_open_"+n);t.css("display")=="none"&&(t.show(),$("#code_img_opened_"+n).show(),$("#code_img_closed_"+n).hide(),$(t).find("span.cnblogs_code_copy").length||showCopyCode(t))}function cnblogs_code_hide(n,t){$("#cnblogs_code_open_"+n).css("display")!="none"&&($("#cnblogs_code_open_"+n).hide(),$("#code_img_opened_"+n).hide(),$("#code_img_closed_"+n).show(),t.stopPropagation?t.stopPropagation():window.event&&(window.event.cancelBubble=!0))}function getWeeklyRepuRank(){$.get("/list/GetRepuRank",function(n){$("#right_weekexpert").after(n)},"html")}$(function(){if($(window).width()<=767)for(var t=document.links,n=0,i=t.length;n<i;n++)t[n].target==="_blank"&&t[n].removeAttribute("target")}),function(){var t=window.document,n=n||{merge:function(){var n=arguments,t,i;if(!(n.length<2)){if(n[0]!=null)for(t=1;t<n.length;t++)for(i in n[t])n[0][i]=n[t][i];return n[0]}},mergeIfNotExist:function(){var n=arguments,t,i;if(!(n.length<2)){for(t=1;t<n.length;t++)for(i in n[t])n[0][i]==null&&(n[0][i]=n[t][i]);return n[0]}}};n.array=n.array||{distinct:function(n){for(var i=0,r="_"+ +new Date+Math.random(),u=[],f={string:{},boolean:{},number:{}},t,e=n.length,o=[];i<e;i++)if(t=n[i],t!=null)if(tp=typeof t,tp in f)t in f[tp]||(f[tp][t]=1,o.push(t));else{if(t[r])continue;t[r]=1;u.push(t);o.push(t)}for(i=0,e=u.length;i<e;i++)t=u[i],t[r]=undefined,delete t[r];return o},indexOf:function(n,t,i){if(Array.prototype.indexOf)return n.indexOf(t,i||0);for(var r=i||0,u=n.length;r<u;r++)if(n[r]===t)return r;return-1},filter:function(n,t){for(var r=[],i=0,u=n.length;i<u;i++)t.call(n[i],i,n[i])&&r.push(n[i]);return r},removeEmpty:function(n){for(var t=0,i=n.length;t<i;)n[t]==""||n[t]==null?(n.splice(t,1),i=n.lehgth):t++;return n},deleteFromArray:function(n,t){for(var i=this.indexOf(n,t);i!=-1;)n.splice(i,1),i=this.indexOf(n,t,i||0);return n}};n.html=n.html||{encode:function(n){var i=t.createElement("div"),r=t.createTextNode(n);return i.appendChild(r),i.innerHTML.replace(/"/g,"&quot;").replace(/'/g,"&#039;").replace(/ /g,"&nbsp;")},decode:function(n){var i=t.createElement("div");return i.innerHTML=n,i.innerText||i.textContent}};n.storage=n.storage||{getCookie:function(n){var i,r;return n?t.cookie.length>0&&(i=t.cookie.indexOf(n+"="),i!=-1)?(i=i+n.length+1,r=t.cookie.indexOf(";",i),r==-1&&(r=t.cookie.length),decodeURIComponent(t.cookie.substring(i,r))):"":""},setCookie:function(n,i,r){if(n){var u=new Date;u.setTime(u.getTime()+r*1e3);t.cookie=n+"="+encodeURIComponent(i)+";expires="+u.toGMTString()+";"}},deleteCookie:function(n){n&&(t.cookie=n+"=; expires=Thu, 01 Jan 1970 00:00:01 GMT;")},getStorage:function(n){if(n)return window.localStorage?decodeURIComponent(localStorage.getItem(n)):this.getCookie(n)},setStorage:function(n,t,i){n&&(window.localStorage?localStorage.setItem(n,encodeURIComponent(t)):this.setCookie(n,t,i))},deleteStorage:function(n){n&&(window.localStorage?localStorage.removeItem(n):this.deleteCookie(n))}};n.date=n.date||{daysInFebruary:function(n){var t=0;if(n instanceof Date)t=n.getFullYear();else if(typeof n=="number")t=n;else return 0;return t%4==0&&(t%100!=0||t%400==0)?29:28},daysInYear:function(n){var t=0;if(n instanceof Date)t=n.getFullYear();else if(typeof n=="number")t=n;else return 0;return t%4==0&&(t%100!=0||t%400==0)?366:365},format:function(n,t,i){var r={};r.Year=n.getFullYear();r.TYear=(""+r.Year).substr(2);r.Month=n.getMonth()+1;r.TMonth=r.Month<10?"0"+r.Month:r.Month;r.Day=n.getDate();r.TDay=r.Day<10?"0"+r.Day:r.Day;r.Hour=n.getHours();r.THour=r.Hour<10?"0"+r.Hour:r.Hour;r.hour=r.Hour<13?r.Hour:r.Hour-12;r.Thour=r.hour<10?"0"+r.hour:r.hour;r.Minute=n.getMinutes();r.TMinute=r.Minute<10?"0"+r.Minute:r.Minute;r.Second=n.getSeconds();r.TSecond=r.Second<10?"0"+r.Second:r.Second;r.Millisecond=n.getMilliseconds();r.Week=n.getDay();var u=["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],f=["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],e=r.Millisecond/1e3;return t!=undefined&&t.replace(/\s/g,"").length>0?(i!=undefined&&i==="en"&&(u=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].slice(0),f=["Sun","Mon","Tue","Web","Thu","Fri","Sat"].slice(0)),t=t.replace(/yyyy/ig,r.Year).replace(/yyy/ig,r.Year).replace(/yy/ig,r.TYear).replace(/y/ig,r.TYear).replace(/MMM/g,u[r.Month-1]).replace(/MM/g,r.TMonth).replace(/M/g,r.Month).replace(/dd/ig,r.TDay).replace(/d/ig,r.Day).replace(/HH/g,r.THour).replace(/H/g,r.Hour).replace(/hh/g,r.Thour).replace(/h/g,r.hour).replace(/mm/g,r.TMinute).replace(/m/g,r.Minute).replace(/ss/ig,r.TSecond).replace(/s/ig,r.Second).replace(/fff/ig,r.Millisecond).replace(/ff/ig,e.toFixed(2)*100).replace(/f/ig,e.toFixed(1)*10).replace(/EEE/g,f[r.Week])):t=r.Year+"-"+r.Month+"-"+r.Day+" "+r.Hour+":"+r.Minute+":"+r.Second,t},diff:function(n,t){var i=parseInt((n-t)/1e3);return i<60?i+"秒":i<3600?Math.floor(i/60)+"分钟":i<86400?Math.floor(i/3600)+"小时":i<604800?Math.floor(i/86400)+"天":i<2678400?Math.floor(i/604800)+"周":i<31536e3?Math.floor(i/2592e3)+"月":i<31536e6?Math.floor(i/31536e3)+"年":Math.floor(i/86400)+"天"},interval:function(n,t){var i=parseInt((n-t)/1e3),r=Math.floor(i/86400),u=Math.floor((i-r*86400)/3600),f=Math.floor((i-r*86400-u*3600)/60),e=Math.floor(i-r*86400-u*3600-f*60);return r+"天:"+u+"小时:"+f+"分钟:"+e+"秒"}};n.string=n.string||{replaceURLWithHTMLLinks:function(n,t){var i=/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/ig;return t?n.replace(i,"<a target='_blank' href='$1'>$1<\/a>"):n.replace(i,"<a href='$1'>$1<\/a>")},getLength:function(n,t){var i=/[\u4e00-\u9fa5]/g;return t!=undefined&&t===!1?n.length:i.test(n)?n.replace(i,"zz").length:n.length}};n.cnblogs=n.cnblogs||{getPassportHost:function(){return"http://"+location.hostname.replace(/[a-zA-Z0-9.]+.cnblogs/,"passport.cnblogs")+"/"},login:function(){return location.href=this.getPassportHost()+"login.aspx?ReturnUrl="+location.href,!1},register:function(){return location.href=this.getPassportHost()+"register.aspx?ReturnUrl="+location.href,!1},logout:function(){return confirm("确定要退出吗？")&&(location.href=this.getPassportHost()+"logout.aspx?ReturnUrl="+location.href),!1},logout_immediate:function(){return location.href=this.getPassportHost()+"logout.aspx?ReturnUrl="+location.href,!1},addToWz:function(){window.open("http://wz.cnblogs.com/create?t=&u=&c=&i=0","_blank","scrollbars=auto,width=460,height=353,left=100,top=50,status=yes,resizable=yes")},putInWz:function(n,i,r){var h=460,c=353,l=(screen.width-h)/2,a=(screen.height-c)/2,u=t,e=u.selection?u.selection.type!="None"?u.selection.createRange().text:"":u.getSelection?u.getSelection():"",o,f,s;e.length>200&&(e=e.substring(0,200));o=1;f=n||u.title;try{f=window.btoa(unescape(encodeURIComponent(f)))}catch(v){f=encodeURIComponent(f.replace(/</g,"&lt;").replace(/>/g,"&gt;"));o=0}s="http://wz.cnblogs.com/create?t="+f+"&u="+encodeURIComponent(i||u.location.href)+"&c="+encodeURIComponent(r||e)+"&i=0";o==1&&(s+="&base64=1");window.open(s,"_blank","width="+h+",height="+c+",toolbars=0,resizable=1,left="+l+",top="+a)},goTop:function(n,t){$('<div id="goTop"><a href="javascript:void(0);"><img src="//common.cnblogs.com/images/ico_top.gif" alt="Top" title="回到页首"><\/a><\/div>').css({position:"fixed",bottom:(n||10)+"px",right:(t||10)+"px"}).click(function(){$("html,body").scrollTop(0)}).appendTo($("body"))}};window.jutil||(window.jutil=n)}();$(function(){document.location.href.indexOf("q.cnblogs.com/list/inbox")===-1&&(checkfeed(),checkFeedId=setInterval(function(){checkfeed()},3e4),$(window).focus(function(){checkfeed();checkFeedId||(checkFeedId=setInterval(function(){checkfeed()},3e4))}),$(window).blur(function(){clearInterval(checkFeedId);checkFeedId=0}));jutil.cnblogs.goTop()});var checkFeedId;$.ajaxSetup({type:"post",dataType:"json",contentType:"application/json; charset=utf8"});