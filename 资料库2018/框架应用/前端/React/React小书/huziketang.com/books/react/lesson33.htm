<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="baidu-site-verification" content="GNvdsbNFPS" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    
      <title>åŠ¨æ‰‹å®ç° Reduxï¼ˆå››ï¼‰ï¼šå…±äº«ç»“æ„çš„å¯¹è±¡æé«˜æ€§èƒ½ | React.js å°ä¹¦</title>
      <meta name="keywords" content="react.js,web,props,state,javascript" />
      <meta name="description" content="React.js å°ä¹¦æ˜¯ä¸€ä¸ªå¼€æºã€å…è´¹ã€ä¸“ä¸šã€ç®€å•çš„ React.js åœ¨çº¿æ•™ç¨‹ã€‚æç‚¼å®æˆ˜ç»éªŒä¸­åŸºç¡€çš„ã€é‡è¦çš„ã€é¢‘ç¹çš„çŸ¥è¯†è¿›è¡Œé‡ç‚¹è®²è§£ï¼Œè®©ä½ èƒ½ç”¨æœ€å°‘çš„ç²¾åŠ›æ·±å…¥äº†è§£å®æˆ˜ä¸­æœ€éœ€è¦çš„ React.js çŸ¥è¯†ã€‚" />
    

    

    <link rel="icon" href="https://huzidaha.github.io/static/assets/img/favicon.ico">
    <link rel="stylesheet"
href="../../../fonts.googleapis.com/css-family=Inconsolata-400,700.css" tppabs="https://fonts.googleapis.com/css?family=Inconsolata:400,700">
    <link rel="stylesheet" type="text/css" href="assets/css/main.css" tppabs="http://huziketang.com/books/react/assets/css/main.css">
</head>

<body>

    <!-- <div class='float-wechat' id='float-wechat'>
    	<img src='https://huzidaha.github.io/static/assets/img/wechat-user.jpeg' />
      <p>åŠ å…¥ã€ŠReact.js å°ä¹¦ã€‹è¯»è€…äº¤æµç¾¤ï¼Œä¸€èµ·è®¨è®ºã€äº¤æµã€å­¦ä¹ å‰ç«¯æŠ€æœ¯ã€‚</p>
    </div> -->
    <div class="wrapper" id='wrapper'>
      <style media="screen">
@media (max-width: 1335px) and (min-width: 900px) {
	.wrapper {
		margin-left: 329px;
	}
}
@media (max-width: 900px) {
	#table-of-content {
		margin-left: -350px;
	}
}
</style>
<h1 style='position: relative; top: -15px;'>React.js å°ä¹¦</h1>

<link ref='prefetch' href="/books/react/lesson34" />


<nav class='table-of-content' id='table-of-content'>
	<a href="javascript:if(confirm('http://huziketang.com/books/react  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='http://huziketang.com/books/react'" tppabs="http://huziketang.com/books/react">&lt;-- é¦–é¡µ</a>
	<h3>ç¬¬ä¸€é˜¶æ®µ</h3>
  
  
		<a  href="lesson1.htm" tppabs="http://huziketang.com/books/react/lesson1" title="React.js ç®€ä»‹">1. React.js ç®€ä»‹</a>
  
  
  
		<a  href="lesson2.htm" tppabs="http://huziketang.com/books/react/lesson2" title="å‰ç«¯ç»„ä»¶åŒ–ï¼ˆä¸€ï¼‰ï¼šä»ä¸€ä¸ªç®€å•çš„ä¾‹å­è®²èµ·">2. å‰ç«¯ç»„ä»¶åŒ–ï¼ˆä¸€ï¼‰ï¼šä»ä¸€ä¸ªç®€å•çš„ä¾‹å­è®²èµ·</a>
  
  
  
		<a  href="lesson3.htm" tppabs="http://huziketang.com/books/react/lesson3" title="å‰ç«¯ç»„ä»¶åŒ–ï¼ˆäºŒï¼‰ï¼šä¼˜åŒ– DOM æ“ä½œ">3. å‰ç«¯ç»„ä»¶åŒ–ï¼ˆäºŒï¼‰ï¼šä¼˜åŒ– DOM æ“ä½œ</a>
  
  
  
		<a  href="lesson4.htm" tppabs="http://huziketang.com/books/react/lesson4" title="å‰ç«¯ç»„ä»¶åŒ–ï¼ˆä¸‰ï¼‰ï¼šæŠ½è±¡å‡ºå…¬å…±ç»„ä»¶ç±»">4. å‰ç«¯ç»„ä»¶åŒ–ï¼ˆä¸‰ï¼‰ï¼šæŠ½è±¡å‡ºå…¬å…±ç»„ä»¶ç±»</a>
  
  
  
		<a  href="lesson5.htm" tppabs="http://huziketang.com/books/react/lesson5" title="React.js åŸºæœ¬ç¯å¢ƒå®‰è£…">5. React.js åŸºæœ¬ç¯å¢ƒå®‰è£…</a>
  
  
  
		<a  href="lesson6.htm" tppabs="http://huziketang.com/books/react/lesson6" title="ä½¿ç”¨ JSX æè¿° UI ä¿¡æ¯">6. ä½¿ç”¨ JSX æè¿° UI ä¿¡æ¯</a>
  
  
  
		<a  href="lesson7.htm" tppabs="http://huziketang.com/books/react/lesson7" title="ç»„ä»¶çš„ render æ–¹æ³•">7. ç»„ä»¶çš„ render æ–¹æ³•</a>
  
  
  
		<a  href="lesson8.htm" tppabs="http://huziketang.com/books/react/lesson8" title="ç»„ä»¶çš„ç»„åˆã€åµŒå¥—å’Œç»„ä»¶æ ‘">8. ç»„ä»¶çš„ç»„åˆã€åµŒå¥—å’Œç»„ä»¶æ ‘</a>
  
  
  
		<a  href="lesson9.htm" tppabs="http://huziketang.com/books/react/lesson9" title="äº‹ä»¶ç›‘å¬">9. äº‹ä»¶ç›‘å¬</a>
  
  
  
		<a  href="lesson10.htm" tppabs="http://huziketang.com/books/react/lesson10" title="ç»„ä»¶çš„ state å’Œ setState">10. ç»„ä»¶çš„ state å’Œ setState</a>
  
  
  
		<a  href="lesson11.htm" tppabs="http://huziketang.com/books/react/lesson11" title="é…ç½®ç»„ä»¶çš„ props">11. é…ç½®ç»„ä»¶çš„ props</a>
  
  
  
		<a  href="lesson12.htm" tppabs="http://huziketang.com/books/react/lesson12" title="state vs props">12. state vs props</a>
  
  
  
		<a  href="lesson13.htm" tppabs="http://huziketang.com/books/react/lesson13" title="æ¸²æŸ“åˆ—è¡¨æ•°æ®">13. æ¸²æŸ“åˆ—è¡¨æ•°æ®</a>
  
  
  
		<a  href="lesson14.htm" tppabs="http://huziketang.com/books/react/lesson14" title="å®æˆ˜åˆ†æï¼šè¯„è®ºåŠŸèƒ½ï¼ˆä¸€ï¼‰">14. å®æˆ˜åˆ†æï¼šè¯„è®ºåŠŸèƒ½ï¼ˆä¸€ï¼‰</a>
  
  
  
		<a  href="lesson15.htm" tppabs="http://huziketang.com/books/react/lesson15" title="å®æˆ˜åˆ†æï¼šè¯„è®ºåŠŸèƒ½ï¼ˆäºŒï¼‰">15. å®æˆ˜åˆ†æï¼šè¯„è®ºåŠŸèƒ½ï¼ˆäºŒï¼‰</a>
  
  
  
		<a  href="lesson16.htm" tppabs="http://huziketang.com/books/react/lesson16" title="å®æˆ˜åˆ†æï¼šè¯„è®ºåŠŸèƒ½ï¼ˆä¸‰ï¼‰">16. å®æˆ˜åˆ†æï¼šè¯„è®ºåŠŸèƒ½ï¼ˆä¸‰ï¼‰</a>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
	<h3>ç¬¬äºŒé˜¶æ®µ</h3>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
		<a  href="lesson17.htm" tppabs="http://huziketang.com/books/react/lesson17" title="å‰ç«¯åº”ç”¨çŠ¶æ€ç®¡ç† â€”â€” çŠ¶æ€æå‡">17. å‰ç«¯åº”ç”¨çŠ¶æ€ç®¡ç† â€”â€” çŠ¶æ€æå‡</a>
  
  
  
		<a  href="lesson18.htm" tppabs="http://huziketang.com/books/react/lesson18" title="æŒ‚è½½é˜¶æ®µçš„ç»„ä»¶ç”Ÿå‘½å‘¨æœŸï¼ˆä¸€ï¼‰">18. æŒ‚è½½é˜¶æ®µçš„ç»„ä»¶ç”Ÿå‘½å‘¨æœŸï¼ˆä¸€ï¼‰</a>
  
  
  
		<a  href="lesson19.htm" tppabs="http://huziketang.com/books/react/lesson19" title="æŒ‚è½½é˜¶æ®µçš„ç»„ä»¶ç”Ÿå‘½å‘¨æœŸï¼ˆäºŒï¼‰">19. æŒ‚è½½é˜¶æ®µçš„ç»„ä»¶ç”Ÿå‘½å‘¨æœŸï¼ˆäºŒï¼‰</a>
  
  
  
		<a  href="lesson20.htm" tppabs="http://huziketang.com/books/react/lesson20" title="æ›´æ–°é˜¶æ®µçš„ç»„ä»¶ç”Ÿå‘½å‘¨æœŸ">20. æ›´æ–°é˜¶æ®µçš„ç»„ä»¶ç”Ÿå‘½å‘¨æœŸ</a>
  
  
  
		<a  href="lesson21.htm" tppabs="http://huziketang.com/books/react/lesson21" title="ref å’Œ React.js ä¸­çš„ DOM æ“ä½œ">21. ref å’Œ React.js ä¸­çš„ DOM æ“ä½œ</a>
  
  
  
		<a  href="lesson22.htm" tppabs="http://huziketang.com/books/react/lesson22" title="props.children å’Œå®¹å™¨ç±»ç»„ä»¶">22. props.children å’Œå®¹å™¨ç±»ç»„ä»¶</a>
  
  
  
		<a  href="lesson23.htm" tppabs="http://huziketang.com/books/react/lesson23" title="dangerouslySetHTML å’Œ style å±æ€§">23. dangerouslySetHTML å’Œ style å±æ€§</a>
  
  
  
		<a  href="lesson24.htm" tppabs="http://huziketang.com/books/react/lesson24" title="PropTypes å’Œç»„ä»¶å‚æ•°éªŒè¯">24. PropTypes å’Œç»„ä»¶å‚æ•°éªŒè¯</a>
  
  
  
		<a  href="lesson25.htm" tppabs="http://huziketang.com/books/react/lesson25" title="å®æˆ˜åˆ†æï¼šè¯„è®ºåŠŸèƒ½ï¼ˆå››ï¼‰">25. å®æˆ˜åˆ†æï¼šè¯„è®ºåŠŸèƒ½ï¼ˆå››ï¼‰</a>
  
  
  
		<a  href="lesson26.htm" tppabs="http://huziketang.com/books/react/lesson26" title="å®æˆ˜åˆ†æï¼šè¯„è®ºåŠŸèƒ½ï¼ˆäº”ï¼‰">26. å®æˆ˜åˆ†æï¼šè¯„è®ºåŠŸèƒ½ï¼ˆäº”ï¼‰</a>
  
  
  
		<a  href="lesson27.htm" tppabs="http://huziketang.com/books/react/lesson27" title="å®æˆ˜åˆ†æï¼šè¯„è®ºåŠŸèƒ½ï¼ˆå…­ï¼‰">27. å®æˆ˜åˆ†æï¼šè¯„è®ºåŠŸèƒ½ï¼ˆå…­ï¼‰</a>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
	<h3>ç¬¬ä¸‰é˜¶æ®µ</h3>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
		<a  href="lesson28.htm" tppabs="http://huziketang.com/books/react/lesson28" title="é«˜é˜¶ç»„ä»¶ï¼ˆHigher-Order Componentsï¼‰">28. é«˜é˜¶ç»„ä»¶ï¼ˆHigher-Order Componentsï¼‰</a>
  
  
  
		<a  href="lesson29.htm" tppabs="http://huziketang.com/books/react/lesson29" title="React.js çš„ context">29. React.js çš„ context</a>
  
  
  
		<a  href="lesson30.htm" tppabs="http://huziketang.com/books/react/lesson30" title="åŠ¨æ‰‹å®ç° Reduxï¼ˆä¸€ï¼‰ï¼šä¼˜é›…åœ°ä¿®æ”¹å…±äº«çŠ¶æ€">30. åŠ¨æ‰‹å®ç° Reduxï¼ˆä¸€ï¼‰ï¼šä¼˜é›…åœ°ä¿®æ”¹å…±äº«çŠ¶æ€</a>
  
  
  
		<a  href="lesson31.htm" tppabs="http://huziketang.com/books/react/lesson31" title="åŠ¨æ‰‹å®ç° Reduxï¼ˆäºŒï¼‰ï¼šæŠ½ç¦» store å’Œç›‘æ§æ•°æ®å˜åŒ–">31. åŠ¨æ‰‹å®ç° Reduxï¼ˆäºŒï¼‰ï¼šæŠ½ç¦» store å’Œç›‘æ§æ•°æ®å˜åŒ–</a>
  
  
  
		<a  href="lesson32.htm" tppabs="http://huziketang.com/books/react/lesson32" title="åŠ¨æ‰‹å®ç° Reduxï¼ˆä¸‰ï¼‰ï¼šçº¯å‡½æ•°ï¼ˆPure Functionï¼‰ç®€ä»‹">32. åŠ¨æ‰‹å®ç° Reduxï¼ˆä¸‰ï¼‰ï¼šçº¯å‡½æ•°ï¼ˆPure Functionï¼‰ç®€ä»‹</a>
  
  
  
		<a  class='active'  href="lesson33.htm" tppabs="http://huziketang.com/books/react/lesson33" title="åŠ¨æ‰‹å®ç° Reduxï¼ˆå››ï¼‰ï¼šå…±äº«ç»“æ„çš„å¯¹è±¡æé«˜æ€§èƒ½">33. åŠ¨æ‰‹å®ç° Reduxï¼ˆå››ï¼‰ï¼šå…±äº«ç»“æ„çš„å¯¹è±¡æé«˜æ€§èƒ½</a>
  
  
  
		<a  href="lesson34.htm" tppabs="http://huziketang.com/books/react/lesson34" title="åŠ¨æ‰‹å®ç° Reduxï¼ˆäº”ï¼‰ï¼šä¸è¦é—®ä¸ºä»€ä¹ˆçš„ reducer">34. åŠ¨æ‰‹å®ç° Reduxï¼ˆäº”ï¼‰ï¼šä¸è¦é—®ä¸ºä»€ä¹ˆçš„ reducer</a>
  
  
  
		<a  href="lesson35.htm" tppabs="http://huziketang.com/books/react/lesson35" title="åŠ¨æ‰‹å®ç° Reduxï¼ˆå…­ï¼‰ï¼šRedux æ€»ç»“">35. åŠ¨æ‰‹å®ç° Reduxï¼ˆå…­ï¼‰ï¼šRedux æ€»ç»“</a>
  
  
  
		<a  href="lesson36.htm" tppabs="http://huziketang.com/books/react/lesson36" title="åŠ¨æ‰‹å®ç° React-reduxï¼ˆä¸€ï¼‰ï¼šåˆå§‹åŒ–å·¥ç¨‹">36. åŠ¨æ‰‹å®ç° React-reduxï¼ˆä¸€ï¼‰ï¼šåˆå§‹åŒ–å·¥ç¨‹</a>
  
  
  
		<a  href="lesson37.htm" tppabs="http://huziketang.com/books/react/lesson37" title="åŠ¨æ‰‹å®ç° React-reduxï¼ˆäºŒï¼‰ï¼šç»“åˆ context å’Œ store">37. åŠ¨æ‰‹å®ç° React-reduxï¼ˆäºŒï¼‰ï¼šç»“åˆ context å’Œ store</a>
  
  
  
		<a  href="lesson38.htm" tppabs="http://huziketang.com/books/react/lesson38" title="åŠ¨æ‰‹å®ç° React-reduxï¼ˆä¸‰ï¼‰ï¼šconnect å’Œ mapStateToProps">38. åŠ¨æ‰‹å®ç° React-reduxï¼ˆä¸‰ï¼‰ï¼šconnect å’Œ mapStateToProps</a>
  
  
  
		<a  href="lesson39.htm" tppabs="http://huziketang.com/books/react/lesson39" title="åŠ¨æ‰‹å®ç° React-reduxï¼ˆå››ï¼‰ï¼šmapDispatchToProps">39. åŠ¨æ‰‹å®ç° React-reduxï¼ˆå››ï¼‰ï¼šmapDispatchToProps</a>
  
  
  
		<a  href="lesson40.htm" tppabs="http://huziketang.com/books/react/lesson40" title="åŠ¨æ‰‹å®ç° React-reduxï¼ˆäº”ï¼‰ï¼šProvider">40. åŠ¨æ‰‹å®ç° React-reduxï¼ˆäº”ï¼‰ï¼šProvider</a>
  
  
  
		<a  href="lesson41.htm" tppabs="http://huziketang.com/books/react/lesson41" title="åŠ¨æ‰‹å®ç° React-reduxï¼ˆå…­ï¼‰ï¼šReact-redux æ€»ç»“">41. åŠ¨æ‰‹å®ç° React-reduxï¼ˆå…­ï¼‰ï¼šReact-redux æ€»ç»“</a>
  
  
  
		<a  href="lesson42.htm" tppabs="http://huziketang.com/books/react/lesson42" title="ä½¿ç”¨çœŸæ­£çš„ Redux å’Œ React-redux">42. ä½¿ç”¨çœŸæ­£çš„ Redux å’Œ React-redux</a>
  
  
  
		<a  href="lesson43.htm" tppabs="http://huziketang.com/books/react/lesson43" title="Smart ç»„ä»¶ vs Dumb ç»„ä»¶">43. Smart ç»„ä»¶ vs Dumb ç»„ä»¶</a>
  
  
  
		<a  href="lesson44.htm" tppabs="http://huziketang.com/books/react/lesson44" title="å®æˆ˜åˆ†æï¼šè¯„è®ºåŠŸèƒ½ï¼ˆä¸ƒï¼‰">44. å®æˆ˜åˆ†æï¼šè¯„è®ºåŠŸèƒ½ï¼ˆä¸ƒï¼‰</a>
  
  
  
		<a  href="lesson45.htm" tppabs="http://huziketang.com/books/react/lesson45" title="å®æˆ˜åˆ†æï¼šè¯„è®ºåŠŸèƒ½ï¼ˆå…«ï¼‰">45. å®æˆ˜åˆ†æï¼šè¯„è®ºåŠŸèƒ½ï¼ˆå…«ï¼‰</a>
  
  
  
		<a  href="lesson46.htm" tppabs="http://huziketang.com/books/react/lesson46" title="å®æˆ˜åˆ†æï¼šè¯„è®ºåŠŸèƒ½ï¼ˆä¹ï¼‰">46. å®æˆ˜åˆ†æï¼šè¯„è®ºåŠŸèƒ½ï¼ˆä¹ï¼‰</a>
  
  
</nav>
<div id="mask-template">
	<div></div>
</div>
<style>
	#granted-modal {
		display: none;
		position: fixed;
		margin: auto;
		left: 100px;
		top: 0;
		bottom: 100px;
		right: 0;
		width: 500px;
		height: 300px;
		background: #fff;
		z-index: 100;
		border-radius: 5px;
	}
	#try-to-buy {
		display: none;
	}
	.error-message {
    position: absolute;
    bottom: 7px;
    right: -30px;
    font-size: 12px;
    color: rgb(211, 53, 62);
  }
	.field {
		position: relative;
		margin-top: 25px;
	}
	.modal-head {
		font-size: 20px;
    text-align: center;
    margin-top: 30px;
	}
	.granted-footer {
		text-align: center;
	}
	#back-to-input {
		font-size: 12px;
    position: absolute;
    top: 10px;
    left: 15px;
	}
	.hover {
		cursor: pointer;
	}
	.granted-footer {
		position: absolute;
    margin: auto;
		padding-top: 15px;
    left: 30px;
    right: 30px;
    bottom: 20px;
		border-top: 1px solid #eee;
	}
	#buy-now {
		color: #00a854;
	}
	.field label {
		display: inline-block;
		width: 90px;
		text-align: right;
	}
	.field label::after {
		content: "ï¼š"
	}
	.granted-form {
		width: 80%;
		margin: 0 auto;
		margin-top: 25px;
	}
	.submit {
		display: inline-block;
		float: right;
	}
	.button {
		background: #f7f7f7;
		border: 1px solid #ccc;
		padding: 5px 20px;
		border-radius: 3px;
		outline: none;
	}
	.button:hover {
		background: #fff;
	}
	.field input {
    padding: 6px 10px;
    border-radius: 4px;
    border: 1px solid #e0dbdb;
    width: 166px;
	}
</style>
<div id="granted-modal">
	<div style="padding: 10px;">
		<div id="readcode-input-area">
			<h2 class="modal-head">é˜…è¯»ç¬¬ä¸‰é˜¶æ®µï¼Œè¯·è¾“å…¥ä½ çš„é˜…è¯»ç  </h2>
			<form class="granted-form" id="read-code-form">
				<div class="field">
					<label>Email</label>
					<input type="email" id="email">
				</div>
				<div class="field">
					<label>é˜…è¯»ç </label>
					<input type="text" id="read-code">
				</div>
				<button id="check-granted" class="button hover submit">ç¡®è®¤</button>
			</form>
			<div class="granted-footer">
				è¿˜æ²¡æœ‰é˜…è¯»ç ï¼Ÿ<b>Â¥10</b> å…ƒå³å¯é˜…è¯»æ‰€æœ‰ç« èŠ‚
				<p style="margin-top: 10px;"><a class="hover" id="buy-now">é©¬ä¸Šè·å–é˜…è¯»ç </a></p>
			</div>
		</div>
		<div id="try-to-buy">
			<div id="back-to-input" class="hover">&lt;&lt; è¿”å›</div>
			<h2 class="modal-head">è¾“å…¥ä½ çš„é‚®ç®±ï¼Œç³»ç»Ÿä¼šç»™ä½ å‘é€é‚®ä»¶</h2>
			<form class="granted-form" id="get-read-code-form">
				<div class="field">
					<label>Email</label>
					<input type="email" id="reader-email">
				</div>
				<button id="alipay" style="margin-top: 20px;" class="hover submit button">è·å–é˜…è¯»ç </button>
			</form>
		</div>
	</div>
</div>
<script src="assets/js/jquery-3.2.1.min.js" tppabs="http://huziketang.com/books/react/assets/js/jquery-3.2.1.min.js"></script>
<script src="assets/js/pay.min.js" tppabs="http://huziketang.com/books/react/assets/js/pay.min.js"></script>
<script type="text/javascript">
var tableOfContent = document.getElementById('table-of-content')
var timer = null
function resetTableOfContent (rect) {
  scrollTop = localStorage.getItem('scrollTop') * 1
  scrollTop = scrollTop || 0
  tableOfContent.scrollTop = scrollTop
}
tableOfContent.addEventListener('scroll', function (event) {
  clearTimeout(timer)
  timer = setTimeout(function() {
    localStorage.setItem('scrollTop', tableOfContent.scrollTop)
  }, 50)
}, false)
resetTableOfContent()
</script>
<div class="post">
	<div class="post__back">
  	<a href="javascript:if(confirm('http://huziketang.com/books/react  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='http://huziketang.com/books/react'" tppabs="http://huziketang.com/books/react">&lt;-- è¿”å›é¦–é¡µ</a>
    <div class="post__title">
    	<h1>åŠ¨æ‰‹å®ç° Reduxï¼ˆå››ï¼‰ï¼šå…±äº«ç»“æ„çš„å¯¹è±¡æé«˜æ€§èƒ½</h1>
    </div>
    <div class="post__meta">
    	<p></p>
    </div>
    <div class="post__content"?>
      <ul style="font-size: 14px; margin-top: -10px;">
  <li>
    ä½œè€…ï¼š<a href="javascript:if(confirm('https://www.zhihu.com/people/hu-zi-da-ha  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://www.zhihu.com/people/hu-zi-da-ha'" tppabs="https://www.zhihu.com/people/hu-zi-da-ha" target="_blank">èƒ¡å­å¤§å“ˆ</a>
  </li>
  <li>
    åŸæ–‡é“¾æ¥ï¼š<a href="lesson33.htm" tppabs="http://huziketang.com/books/react/lesson33"> http://huziketang.com/books/react/lesson33 </a>
  </li>
  <li>è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼Œä¿ç•™åŸæ–‡é“¾æ¥å’Œä½œè€…ä¿¡æ¯ã€‚</li>
</ul>

<p>ï¼ˆæœ¬æ–‡æœªå®¡æ ¸ï¼‰</p>

<p>æ¥ä¸‹æ¥ä¸¤èŠ‚æŸäº›åœ°æ–¹å¯èƒ½ä¼šç¨å¾®æœ‰ä¸€ç‚¹ç‚¹æŠ½è±¡ï¼Œä½†æ˜¯æˆ‘ä¼šå°½å¯èƒ½ç”¨ç®€å•çš„æ–¹å¼è¿›è¡Œè®²è§£ã€‚å¦‚æœä½ è§‰å¾—ç†è§£èµ·æ¥æœ‰ç‚¹å›°éš¾ï¼Œå¯ä»¥æŠŠè¿™å‡ èŠ‚å¤šè¯»å¤šç†è§£å‡ éï¼Œå…¶å®æˆ‘ä»¬ä¸€è·¯èµ°æ¥éƒ½æ˜¯ç¬¦åˆâ€œé€»è¾‘â€çš„ï¼Œéƒ½æ˜¯å‘ç°é—®é¢˜ã€æ€è€ƒé—®é¢˜ã€ä¼˜åŒ–ä»£ç çš„è¿‡ç¨‹ã€‚æ‰€ä»¥æœ€å¥½èƒ½å¤Ÿç”¨å¿ƒç•™æ„ã€æ€è€ƒæˆ‘ä»¬æ¯ä¸€ä¸ªæå‡ºæ¥çš„é—®é¢˜ã€‚</p>

<p>ç»†å¿ƒçš„æœ‹å‹å¯ä»¥å‘ç°ï¼Œå…¶å®æˆ‘ä»¬ä¹‹å‰çš„ä¾‹å­å½“ä¸­æ˜¯æœ‰æ¯”è¾ƒä¸¥é‡çš„<em>æ€§èƒ½é—®é¢˜</em>çš„ã€‚æˆ‘ä»¬åœ¨æ¯ä¸ªæ¸²æŸ“å‡½æ•°çš„å¼€å¤´æ‰“ä¸€äº› Log çœ‹çœ‹ï¼š</p>

<pre><code class="language-javascript">function renderApp (appState) {
  console.log('render app...')
  renderTitle(appState.title)
  renderContent(appState.content)
}

function renderTitle (title) {
  console.log('render title...')
  const titleDOM = document.getElementById('title')
  titleDOM.innerHTML = title.text
  titleDOM.style.color = title.color
}

function renderContent (content) {
  console.log('render content...')
  const contentDOM = document.getElementById('content')
  contentDOM.innerHTML = content.text
  contentDOM.style.color = content.color
}
</code></pre>

<p>ä¾æ—§æ‰§è¡Œä¸€æ¬¡åˆå§‹åŒ–æ¸²æŸ“ï¼Œå’Œä¸¤æ¬¡æ›´æ–°ï¼Œè¿™é‡Œä»£ç ä¿æŒä¸å˜ï¼š</p>

<pre><code class="language-javascript">const store = createStore(appState, stateChanger)
store.subscribe(() =&gt; renderApp(store.getState())) // ç›‘å¬æ•°æ®å˜åŒ–

renderApp(store.getState()) // é¦–æ¬¡æ¸²æŸ“é¡µé¢
store.dispatch({ type: 'UPDATE_TITLE_TEXT', text: 'ã€ŠReact.js å°ä¹¦ã€‹' }) // ä¿®æ”¹æ ‡é¢˜æ–‡æœ¬
store.dispatch({ type: 'UPDATE_TITLE_COLOR', color: 'blue' }) // ä¿®æ”¹æ ‡é¢˜é¢œè‰²
</code></pre>

<p>å¯ä»¥åœ¨æ§åˆ¶å°çœ‹åˆ°ï¼š</p>

<p><a href="javascript:if(confirm('http://huzidaha.github.io/static/assets/img/posts/39AC7FAA-0332-448E-8B00-7A1719F048DE.png  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='http://huzidaha.github.io/static/assets/img/posts/39AC7FAA-0332-448E-8B00-7A1719F048DE.png'" tppabs="http://huzidaha.github.io/static/assets/img/posts/39AC7FAA-0332-448E-8B00-7A1719F048DE.png" target="_blank"><img src="../../../huzidaha.github.io/static/assets/img/posts/39AC7FAA-0332-448E-8B00-7A1719F048DE.png" tppabs="http://huzidaha.github.io/static/assets/img/posts/39AC7FAA-0332-448E-8B00-7A1719F048DE.png" alt="å®ä¾‹å›¾ç‰‡" /></a></p>

<p>å‰ä¸‰ä¸ªæ¯«æ— ç–‘é—®æ˜¯ç¬¬ä¸€æ¬¡æ¸²æŸ“æ‰“å°å‡ºæ¥çš„ã€‚ä¸­é—´ä¸‰ä¸ªæ˜¯ç¬¬ä¸€æ¬¡ <code>store.dispatch</code> å¯¼è‡´çš„ï¼Œæœ€åä¸‰ä¸ªæ˜¯ç¬¬äºŒæ¬¡ <code>store.dispatch</code> å¯¼è‡´çš„ã€‚å¯ä»¥çœ‹åˆ°é—®é¢˜å°±æ˜¯ï¼Œæ¯å½“æ›´æ–°æ•°æ®å°±é‡æ–°æ¸²æŸ“æ•´ä¸ª Appï¼Œä½†å…¶å®æˆ‘ä»¬ä¸¤æ¬¡æ›´æ–°éƒ½æ²¡æœ‰åŠ¨åˆ° <code>appState</code> é‡Œé¢çš„ <code>content</code> å­—æ®µçš„å¯¹è±¡ï¼Œè€ŒåŠ¨çš„æ˜¯ <code>title</code> å­—æ®µã€‚å…¶å®å¹¶ä¸éœ€è¦é‡æ–° <code>renderContent</code>ï¼Œå®ƒæ˜¯ä¸€ä¸ªå¤šä½™çš„æ›´æ–°æ“ä½œï¼Œç°åœ¨æˆ‘ä»¬éœ€è¦ä¼˜åŒ–å®ƒã€‚</p>

<p>è¿™é‡Œæå‡ºçš„è§£å†³æ–¹æ¡ˆæ˜¯ï¼Œåœ¨æ¯ä¸ªæ¸²æŸ“å‡½æ•°æ‰§è¡Œæ¸²æŸ“æ“ä½œä¹‹å‰å…ˆåšä¸ªåˆ¤æ–­ï¼Œåˆ¤æ–­ä¼ å…¥çš„æ–°æ•°æ®å’Œæ—§çš„æ•°æ®æ˜¯ä¸æ˜¯ç›¸åŒï¼Œç›¸åŒçš„è¯å°±ä¸æ¸²æŸ“äº†ã€‚</p>

<pre><code class="language-javascript">function renderApp (newAppState, oldAppState = {}) { // é˜²æ­¢ oldAppState æ²¡æœ‰ä¼ å…¥ï¼Œæ‰€ä»¥åŠ äº†é»˜è®¤å‚æ•° oldAppState = {}
  if (newAppState === oldAppState) return // æ•°æ®æ²¡æœ‰å˜åŒ–å°±ä¸æ¸²æŸ“äº†
  console.log('render app...')
  renderTitle(newAppState.title, oldAppState.title)
  renderContent(newAppState.content, oldAppState.content)
}

function renderTitle (newTitle, oldTitle = {}) {
  if (newTitle === oldTitle) return // æ•°æ®æ²¡æœ‰å˜åŒ–å°±ä¸æ¸²æŸ“äº†
  console.log('render title...')
  const titleDOM = document.getElementById('title')
  titleDOM.innerHTML = newTitle.text
  titleDOM.style.color = newTitle.color
}

function renderContent (newContent, oldContent = {}) {
  if (newContent === oldContent) return // æ•°æ®æ²¡æœ‰å˜åŒ–å°±ä¸æ¸²æŸ“äº†
  console.log('render content...')
  const contentDOM = document.getElementById('content')
  contentDOM.innerHTML = newContent.text
  contentDOM.style.color = newContent.color
}
</code></pre>

<p>ç„¶åæˆ‘ä»¬ç”¨ä¸€ä¸ª <code>oldState</code> å˜é‡ä¿å­˜æ—§çš„åº”ç”¨çŠ¶æ€ï¼Œåœ¨éœ€è¦é‡æ–°æ¸²æŸ“çš„æ—¶å€™æŠŠæ–°æ—§æ•°æ®ä¼ è¿›å…¥å»ï¼š</p>

<pre><code class="language-javascript">const store = createStore(appState, stateChanger)
let oldState = store.getState() // ç¼“å­˜æ—§çš„ state
store.subscribe(() =&gt; {
  const newState = store.getState() // æ•°æ®å¯èƒ½å˜åŒ–ï¼Œè·å–æ–°çš„ state
  renderApp(newState, oldState) // æŠŠæ–°æ—§çš„ state ä¼ è¿›å»æ¸²æŸ“
  oldState = newState // æ¸²æŸ“å®Œä»¥åï¼Œæ–°çš„ newState å˜æˆäº†æ—§çš„ oldStateï¼Œç­‰å¾…ä¸‹ä¸€æ¬¡æ•°æ®å˜åŒ–é‡æ–°æ¸²æŸ“
})
...
</code></pre>

<p>å¸Œæœ›åˆ°è¿™é‡Œæ²¡æœ‰æŠŠå¤§å®¶å¿½æ‚ åˆ°ï¼Œ<em>ä¸Šé¢çš„ä»£ç æ ¹æœ¬ä¸ä¼šè¾¾åˆ°æˆ‘ä»¬çš„æ•ˆæœ</em>ã€‚çœ‹çœ‹æˆ‘ä»¬çš„ <code>stateChanger</code>ï¼š</p>

<pre><code class="language-javascript">function stateChanger (state, action) {
  switch (action.type) {
    case 'UPDATE_TITLE_TEXT':
      state.title.text = action.text
      break
    case 'UPDATE_TITLE_COLOR':
      state.title.color = action.color
      break
    default:
      break
  }
}
</code></pre>

<p>å³ä½¿ä½ ä¿®æ”¹äº† <code>state.title.text</code>ï¼Œä½†æ˜¯ <code>state</code> è¿˜æ˜¯åŸæ¥é‚£ä¸ª <code>state</code>ï¼Œ<code>state.title</code> è¿˜æ˜¯åŸæ¥çš„ <code>state.title</code>ï¼Œè¿™äº›å¼•ç”¨æŒ‡å‘çš„è¿˜æ˜¯åŸæ¥çš„å¯¹è±¡ï¼Œåªæ˜¯å¯¹è±¡å†…çš„å†…å®¹å‘ç”Ÿäº†æ”¹å˜ã€‚æ‰€ä»¥å³ä½¿ä½ åœ¨æ¯ä¸ªæ¸²æŸ“å‡½æ•°å¼€å¤´åŠ äº†é‚£ä¸ªåˆ¤æ–­åˆä»€ä¹ˆç”¨ï¼Ÿè¿™å°±åƒæ˜¯ä¸‹é¢çš„ä»£ç é‚£æ ·è‡ªæ¬ºæ¬ºäººï¼š</p>

<pre><code class="language-javascript">let appState = {
  title: {
    text: 'React.js å°ä¹¦',
    color: 'red',
  },
  content: {
    text: 'React.js å°ä¹¦å†…å®¹',
    color: 'blue'
  }
}
const oldState = appState
appState.title.text = 'ã€ŠReact.js å°ä¹¦ã€‹'
oldState !== appState // falseï¼Œå…¶å®ä¸¤ä¸ªå¼•ç”¨æŒ‡å‘çš„æ˜¯åŒä¸€ä¸ªå¯¹è±¡ï¼Œæˆ‘ä»¬å´å¸Œæœ›å®ƒä»¬ä¸åŒã€‚
</code></pre>

<p>ä½†æ˜¯ï¼Œæˆ‘ä»¬æ¥ä¸‹æ¥å°±è¦è®©è¿™ç§äº‹æƒ…å˜æˆå¯èƒ½ã€‚</p>

<h2 id="å…±äº«ç»“æ„çš„å¯¹è±¡">å…±äº«ç»“æ„çš„å¯¹è±¡</h2>
<p>å¸Œæœ›å¤§å®¶éƒ½çŸ¥é“è¿™ç§ ES6 çš„è¯­æ³•ï¼š</p>

<pre><code class="language-javascript">const obj = { a: 1, b: 2}
const obj2 = { ...obj } // =&gt; { a: 1, b: 2 }
</code></pre>

<p><code>const obj2 = { ...obj }</code> å…¶å®å°±æ˜¯æ–°å»ºä¸€ä¸ªå¯¹è±¡ <code>obj2</code>ï¼Œç„¶åæŠŠ <code>obj</code> æ‰€æœ‰çš„å±æ€§éƒ½å¤åˆ¶åˆ° <code>obj2</code> é‡Œé¢ï¼Œç›¸å½“äºå¯¹è±¡çš„æµ…å¤åˆ¶ã€‚ä¸Šé¢çš„ <code>obj</code> é‡Œé¢çš„å†…å®¹å’Œ <code>obj2</code> æ˜¯å®Œå…¨ä¸€æ ·çš„ï¼Œä½†æ˜¯å´æ˜¯ä¸¤ä¸ªä¸åŒçš„å¯¹è±¡ã€‚é™¤äº†æµ…å¤åˆ¶å¯¹è±¡ï¼Œè¿˜å¯ä»¥è¦†ç›–ã€æ‹“å±•å¯¹è±¡å±æ€§ï¼š</p>

<pre><code class="language-javascript">const obj = { a: 1, b: 2}
const obj2 = { ...obj, b: 3, c: 4} // =&gt; { a: 1, b: 3, c: 4 }ï¼Œè¦†ç›–äº† bï¼Œæ–°å¢äº† c
</code></pre>

<p>æˆ‘ä»¬å¯ä»¥æŠŠè¿™ç§ç‰¹æ€§åº”ç”¨åœ¨ <code>state</code> çš„æ›´æ–°ä¸Šï¼Œæˆ‘ä»¬ç¦æ­¢ç›´æ¥ä¿®æ”¹åŸæ¥çš„å¯¹è±¡ï¼Œä¸€æ—¦ä½ è¦ä¿®æ”¹æŸäº›ä¸œè¥¿ï¼Œä½ å°±å¾—æŠŠä¿®æ”¹è·¯å¾„ä¸Šçš„æ‰€æœ‰å¯¹è±¡å¤åˆ¶ä¸€éï¼Œä¾‹å¦‚ï¼Œæˆ‘ä»¬ä¸å†™ä¸‹é¢çš„ä¿®æ”¹ä»£ç ï¼š</p>

<pre><code class="language-javascript">appState.title.text = 'ã€ŠReact.js å°ä¹¦ã€‹'
</code></pre>

<p>å–è€Œä»£ä¹‹çš„æ˜¯ï¼Œæˆ‘ä»¬æ–°å»ºä¸€ä¸ª <code>appState</code>ï¼Œæ–°å»º <code>appState.title</code>ï¼Œæ–°å»º <code>appState.title.text</code>ï¼š</p>

<pre><code class="language-javascript">let newAppState = { // æ–°å»ºä¸€ä¸ª newAppState
  ...appState, // å¤åˆ¶ appState é‡Œé¢çš„å†…å®¹
  title: { // ç”¨ä¸€ä¸ªæ–°çš„å¯¹è±¡è¦†ç›–åŸæ¥çš„ title å±æ€§
    ...appState.title, // å¤åˆ¶åŸæ¥ title å¯¹è±¡é‡Œé¢çš„å†…å®¹
    text: 'ã€ŠReact.js å°ä¹¦ã€‹' // è¦†ç›– text å±æ€§
  }
}
</code></pre>

<p>å¦‚æœæˆ‘ä»¬ç”¨ä¸€ä¸ªæ ‘çŠ¶çš„ç»“æ„æ¥è¡¨ç¤ºå¯¹è±¡ç»“æ„çš„è¯ï¼š</p>

<p><a href="javascript:if(confirm('http://huzidaha.github.io/static/assets/img/posts/C8A1EB09-2D4E-442E-AD6D-E4997B4AF1C1.png  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='http://huzidaha.github.io/static/assets/img/posts/C8A1EB09-2D4E-442E-AD6D-E4997B4AF1C1.png'" tppabs="http://huzidaha.github.io/static/assets/img/posts/C8A1EB09-2D4E-442E-AD6D-E4997B4AF1C1.png" target="_blank"><img src="../../../huzidaha.github.io/static/assets/img/posts/C8A1EB09-2D4E-442E-AD6D-E4997B4AF1C1.png" tppabs="http://huzidaha.github.io/static/assets/img/posts/C8A1EB09-2D4E-442E-AD6D-E4997B4AF1C1.png" alt="å®ä¾‹å›¾ç‰‡" /></a></p>

<p><code>appState</code> å’Œ <code>newAppState</code> å…¶å®æ˜¯ä¸¤ä¸ªä¸åŒçš„å¯¹è±¡ï¼Œå› ä¸ºå¯¹è±¡æµ…å¤åˆ¶çš„ç¼˜æ•…ï¼Œå…¶å®å®ƒä»¬é‡Œé¢çš„å±æ€§ <code>content</code> æŒ‡å‘çš„æ˜¯åŒä¸€ä¸ªå¯¹è±¡ï¼›ä½†æ˜¯å› ä¸º <code>title</code> è¢«ä¸€ä¸ªæ–°çš„å¯¹è±¡è¦†ç›–äº†ï¼Œæ‰€ä»¥å®ƒä»¬çš„ <code>title</code> å±æ€§æŒ‡å‘çš„å¯¹è±¡æ˜¯ä¸åŒçš„ã€‚åŒæ ·åœ°ï¼Œä¿®æ”¹ <code>appState.title.color</code>ï¼š</p>

<pre><code class="language-javascript">let newAppState1 = { // æ–°å»ºä¸€ä¸ª newAppState1
  ...newAppState, // å¤åˆ¶ newAppState1 é‡Œé¢çš„å†…å®¹
  title: { // ç”¨ä¸€ä¸ªæ–°çš„å¯¹è±¡è¦†ç›–åŸæ¥çš„ title å±æ€§
    ...newAppState.title, // å¤åˆ¶åŸæ¥ title å¯¹è±¡é‡Œé¢çš„å†…å®¹
    color: "blue" // è¦†ç›– color å±æ€§
  }
}
</code></pre>

<p><a href="javascript:if(confirm('http://huzidaha.github.io/static/assets/img/posts/4E4E9324-4659-4791-8957-137566C3A929.png  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='http://huzidaha.github.io/static/assets/img/posts/4E4E9324-4659-4791-8957-137566C3A929.png'" tppabs="http://huzidaha.github.io/static/assets/img/posts/4E4E9324-4659-4791-8957-137566C3A929.png" target="_blank"><img src="../../../huzidaha.github.io/static/assets/img/posts/4E4E9324-4659-4791-8957-137566C3A929.png" tppabs="http://huzidaha.github.io/static/assets/img/posts/4E4E9324-4659-4791-8957-137566C3A929.png" alt="å®ä¾‹å›¾ç‰‡" /></a></p>

<p>æˆ‘ä»¬æ¯æ¬¡ä¿®æ”¹æŸäº›æ•°æ®çš„æ—¶å€™ï¼Œéƒ½ä¸ä¼šç¢°åŸæ¥çš„æ•°æ®ï¼Œè€Œæ˜¯æŠŠéœ€è¦ä¿®æ”¹æ•°æ®è·¯å¾„ä¸Šçš„å¯¹è±¡éƒ½ copy ä¸€ä¸ªå‡ºæ¥ã€‚è¿™æ ·æœ‰ä»€ä¹ˆå¥½å¤„ï¼Ÿçœ‹çœ‹æˆ‘ä»¬çš„ç›®çš„è¾¾åˆ°äº†ï¼š</p>

<pre><code class="language-javascript">appState !== newAppState // trueï¼Œä¸¤ä¸ªå¯¹è±¡å¼•ç”¨ä¸åŒï¼Œæ•°æ®å˜åŒ–äº†ï¼Œé‡æ–°æ¸²æŸ“
appState.title !== newAppState.title // trueï¼Œä¸¤ä¸ªå¯¹è±¡å¼•ç”¨ä¸åŒï¼Œæ•°æ®å˜åŒ–äº†ï¼Œé‡æ–°æ¸²æŸ“
appState.content !== appState.content // falseï¼Œä¸¤ä¸ªå¯¹è±¡å¼•ç”¨ç›¸åŒï¼Œæ•°æ®æ²¡æœ‰å˜åŒ–ï¼Œä¸éœ€è¦é‡æ–°æ¸²æŸ“
</code></pre>

<p>ä¿®æ”¹æ•°æ®çš„æ—¶å€™å°±æŠŠä¿®æ”¹è·¯å¾„éƒ½å¤åˆ¶ä¸€éï¼Œä½†æ˜¯ä¿æŒå…¶ä»–å†…å®¹ä¸å˜ï¼Œæœ€åçš„æ‰€æœ‰å¯¹è±¡å…·æœ‰æŸäº›ä¸å˜å…±äº«çš„ç»“æ„ï¼ˆä¾‹å¦‚ä¸Šé¢ä¸‰ä¸ªå¯¹è±¡éƒ½å…±äº« <code>content</code> å¯¹è±¡ï¼‰ã€‚å¤§å¤šæ•°æƒ…å†µä¸‹æˆ‘ä»¬å¯ä»¥ä¿æŒ 50% ä»¥ä¸Šçš„å†…å®¹å…·æœ‰å…±äº«ç»“æ„ï¼Œè¿™ç§æ“ä½œå…·æœ‰éå¸¸ä¼˜è‰¯çš„ç‰¹æ€§ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å®ƒæ¥ä¼˜åŒ–ä¸Šé¢çš„æ¸²æŸ“æ€§èƒ½ã€‚</p>

<h2 id="ä¼˜åŒ–æ€§èƒ½">ä¼˜åŒ–æ€§èƒ½</h2>
<p>æˆ‘ä»¬ä¿®æ”¹ <code>stateChanger</code>ï¼Œè®©å®ƒä¿®æ”¹æ•°æ®çš„æ—¶å€™ï¼Œå¹¶ä¸ä¼šç›´æ¥ä¿®æ”¹åŸæ¥çš„æ•°æ® <code>state</code>ï¼Œè€Œæ˜¯äº§ç”Ÿä¸Šè¿°çš„å…±äº«ç»“æ„çš„å¯¹è±¡ï¼š</p>

<pre><code class="language-javascript">function stateChanger (state, action) {
  switch (action.type) {
    case 'UPDATE_TITLE_TEXT':
      return { // æ„å»ºæ–°çš„å¯¹è±¡å¹¶ä¸”è¿”å›
        ...state,
        title: {
          ...state.title,
          text: action.text
        }
      }
    case 'UPDATE_TITLE_COLOR':
      return { // æ„å»ºæ–°çš„å¯¹è±¡å¹¶ä¸”è¿”å›
        ...state,
        title: {
          ...state.title,
          color: action.color
        }
      }
    default:
      return state // æ²¡æœ‰ä¿®æ”¹ï¼Œè¿”å›åŸæ¥çš„å¯¹è±¡
  }
}
</code></pre>

<p>ä»£ç ç¨å¾®æ¯”åŸæ¥é•¿äº†ä¸€ç‚¹ï¼Œä½†æ˜¯æ˜¯å€¼å¾—çš„ã€‚æ¯æ¬¡éœ€è¦ä¿®æ”¹çš„æ—¶å€™éƒ½ä¼šäº§ç”Ÿæ–°çš„å¯¹è±¡ï¼Œå¹¶ä¸”è¿”å›ã€‚è€Œå¦‚æœæ²¡æœ‰ä¿®æ”¹ï¼ˆåœ¨ <code>default</code> è¯­å¥ä¸­ï¼‰åˆ™è¿”å›åŸæ¥çš„ <code>state</code> å¯¹è±¡ã€‚</p>

<p>å› ä¸º <code>stateChanger</code> ä¸ä¼šä¿®æ”¹åŸæ¥å¯¹è±¡äº†ï¼Œè€Œæ˜¯è¿”å›å¯¹è±¡ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ä¿®æ”¹ä¸€ä¸‹ <code>createStore</code>ã€‚è®©å®ƒç”¨æ¯æ¬¡ <code>stateChanger(state, action)</code> çš„è°ƒç”¨ç»“æœè¦†ç›–åŸæ¥çš„ <code>state</code>ï¼š</p>

<pre><code class="language-javascript">function createStore (state, stateChanger) {
  const listeners = []
  const subscribe = (listener) =&gt; listeners.push(listener)
  const getState = () =&gt; state
  const dispatch = (action) =&gt; {
    state = stateChanger(state, action) // è¦†ç›–åŸå¯¹è±¡
    listeners.forEach((listener) =&gt; listener())
  }
  return { getState, dispatch, subscribe }
}
</code></pre>

<p>ä¿æŒä¸Šé¢çš„æ¸²æŸ“å‡½æ•°å¼€å¤´çš„å¯¹è±¡åˆ¤æ–­ä¸å˜ï¼Œå†çœ‹çœ‹æ§åˆ¶å°ï¼š</p>

<p><a href="javascript:if(confirm('http://huzidaha.github.io/static/assets/img/posts/B7386556-7007-4AAB-9E7D-D977DD98CD44.png  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='http://huzidaha.github.io/static/assets/img/posts/B7386556-7007-4AAB-9E7D-D977DD98CD44.png'" tppabs="http://huzidaha.github.io/static/assets/img/posts/B7386556-7007-4AAB-9E7D-D977DD98CD44.png" target="_blank"><img src="../../../huzidaha.github.io/static/assets/img/posts/B7386556-7007-4AAB-9E7D-D977DD98CD44.png" tppabs="http://huzidaha.github.io/static/assets/img/posts/B7386556-7007-4AAB-9E7D-D977DD98CD44.png" alt="å®ä¾‹å›¾ç‰‡" /></a></p>

<p>å‰ä¸‰ä¸ªæ˜¯é¦–æ¬¡æ¸²æŸ“ã€‚åé¢çš„ <code>store.dispatch</code> å¯¼è‡´çš„é‡æ–°æ¸²æŸ“éƒ½æ²¡æœ‰å…³äº <code>content</code> çš„ Log äº†ã€‚å› ä¸ºäº§ç”Ÿå…±äº«ç»“æ„çš„å¯¹è±¡ï¼Œæ–°æ—§å¯¹è±¡çš„ <code>content</code> å¼•ç”¨æŒ‡å‘çš„å¯¹è±¡æ˜¯ä¸€æ ·çš„ï¼Œæ‰€ä»¥è§¦å‘äº† <code>renderContent</code> å‡½æ•°å¼€å¤´çš„ï¼š</p>

<pre><code class="language-javascript">...
  if (newContent === oldContent) return
...
</code></pre>

<p>æˆ‘ä»¬æˆåŠŸåœ°æŠŠä¸å¿…è¦çš„é¡µé¢æ¸²æŸ“ä¼˜åŒ–æ‰äº†ï¼Œé—®é¢˜è§£å†³ã€‚å¦å¤–ï¼Œå¹¶ä¸éœ€è¦æ‹…å¿ƒæ¯æ¬¡ä¿®æ”¹éƒ½æ–°å»ºå…±äº«ç»“æ„å¯¹è±¡ä¼šæœ‰æ€§èƒ½ã€å†…å­˜é—®é¢˜ï¼Œå› ä¸ºæ„å»ºå¯¹è±¡çš„æˆæœ¬éå¸¸ä½ï¼Œè€Œä¸”æˆ‘ä»¬æœ€å¤šä¿å­˜ä¸¤ä¸ªå¯¹è±¡å¼•ç”¨ï¼ˆ<code>oldState</code> å’Œ <code>newState</code>ï¼‰ï¼Œå…¶ä½™æ—§çš„å¯¹è±¡éƒ½ä¼šè¢«åƒåœ¾å›æ”¶æ‰ã€‚</p>

<p>æœ¬èŠ‚å®Œæ•´ä»£ç ï¼š</p>

<pre><code class="language-javascript">function createStore (state, stateChanger) {
  const listeners = []
  const subscribe = (listener) =&gt; listeners.push(listener)
  const getState = () =&gt; state
  const dispatch = (action) =&gt; {
    state = stateChanger(state, action) // è¦†ç›–åŸå¯¹è±¡
    listeners.forEach((listener) =&gt; listener())
  }
  return { getState, dispatch, subscribe }
}

function renderApp (newAppState, oldAppState = {}) { // é˜²æ­¢ oldAppState æ²¡æœ‰ä¼ å…¥ï¼Œæ‰€ä»¥åŠ äº†é»˜è®¤å‚æ•° oldAppState = {}
  if (newAppState === oldAppState) return // æ•°æ®æ²¡æœ‰å˜åŒ–å°±ä¸æ¸²æŸ“äº†
  console.log('render app...')
  renderTitle(newAppState.title, oldAppState.title)
  renderContent(newAppState.content, oldAppState.content)
}

function renderTitle (newTitle, oldTitle = {}) {
  if (newTitle === oldTitle) return // æ•°æ®æ²¡æœ‰å˜åŒ–å°±ä¸æ¸²æŸ“äº†
  console.log('render title...')
  const titleDOM = document.getElementById('title')
  titleDOM.innerHTML = newTitle.text
  titleDOM.style.color = newTitle.color
}

function renderContent (newContent, oldContent = {}) {
  if (newContent === oldContent) return // æ•°æ®æ²¡æœ‰å˜åŒ–å°±ä¸æ¸²æŸ“äº†
  console.log('render content...')
  const contentDOM = document.getElementById('content')
  contentDOM.innerHTML = newContent.text
  contentDOM.style.color = newContent.color
}

let appState = {
  title: {
    text: 'React.js å°ä¹¦',
    color: 'red',
  },
  content: {
    text: 'React.js å°ä¹¦å†…å®¹',
    color: 'blue'
  }
}

function stateChanger (state, action) {
  switch (action.type) {
    case 'UPDATE_TITLE_TEXT':
      return { // æ„å»ºæ–°çš„å¯¹è±¡å¹¶ä¸”è¿”å›
        ...state,
        title: {
          ...state.title,
          text: action.text
        }
      }
    case 'UPDATE_TITLE_COLOR':
      return { // æ„å»ºæ–°çš„å¯¹è±¡å¹¶ä¸”è¿”å›
        ...state,
        title: {
          ...state.title,
          color: action.color
        }
      }
    default:
      return state // æ²¡æœ‰ä¿®æ”¹ï¼Œè¿”å›åŸæ¥çš„å¯¹è±¡
  }
}

const store = createStore(appState, stateChanger)
let oldState = store.getState() // ç¼“å­˜æ—§çš„ state
store.subscribe(() =&gt; {
  const newState = store.getState() // æ•°æ®å¯èƒ½å˜åŒ–ï¼Œè·å–æ–°çš„ state
  renderApp(newState, oldState) // æŠŠæ–°æ—§çš„ state ä¼ è¿›å»æ¸²æŸ“
  oldState = newState // æ¸²æŸ“å®Œä»¥åï¼Œæ–°çš„ newState å˜æˆäº†æ—§çš„ oldStateï¼Œç­‰å¾…ä¸‹ä¸€æ¬¡æ•°æ®å˜åŒ–é‡æ–°æ¸²æŸ“
})

renderApp(store.getState()) // é¦–æ¬¡æ¸²æŸ“é¡µé¢
store.dispatch({ type: 'UPDATE_TITLE_TEXT', text: 'ã€ŠReact.js å°ä¹¦ã€‹' }) // ä¿®æ”¹æ ‡é¢˜æ–‡æœ¬
store.dispatch({ type: 'UPDATE_TITLE_COLOR', color: 'blue' }) // ä¿®æ”¹æ ‡é¢˜é¢œè‰²
</code></pre>

<hr />

<blockquote>
  <p>å› ä¸ºç¬¬ä¸‰æ–¹è¯„è®ºå·¥å…·æœ‰é—®é¢˜ï¼Œå¯¹æœ¬ç« èŠ‚æœ‰ä»»ä½•ç–‘é—®çš„æœ‹å‹å¯ä»¥ç§»æ­¥åˆ° <a target="_blank" href="javascript:if(confirm('http://scriptoj.com/category/4/react-js-å°ä¹¦äº¤æµåŒº  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='http://scriptoj.com/category/4/react-js-å°ä¹¦äº¤æµåŒº'" tppabs="http://scriptoj.com/category/4/react-js-å°ä¹¦äº¤æµåŒº">React.js å°ä¹¦çš„è®ºå›</a> å‘å¸–ï¼Œæˆ‘ä¼šå›ç­”å¤§å®¶çš„ç–‘é—®ã€‚</p>
</blockquote>

    </div>
		<br/>
		<hr />
		<br />
		<div class="PageNavigation">
			
			<p>
				<a class="next" href="lesson34.htm" tppabs="http://huziketang.com/books/react/lesson34">ä¸‹ä¸€èŠ‚ï¼šåŠ¨æ‰‹å®ç° Reduxï¼ˆäº”ï¼‰ï¼šä¸è¦é—®ä¸ºä»€ä¹ˆçš„ reducer</a>
			</p>
			
			<br/>
			
			<p>
				<a class="prev" href="lesson32.htm" tppabs="http://huziketang.com/books/react/lesson32">ä¸Šä¸€èŠ‚ï¼šåŠ¨æ‰‹å®ç° Reduxï¼ˆä¸‰ï¼‰ï¼šçº¯å‡½æ•°ï¼ˆPure Functionï¼‰ç®€ä»‹</a>
			</p>
			
		</div>
		<!-- <a class="ad" href="https://aonaotu.com" target="_blank"> -->
			<!-- <div class="ad-logo">
				<img src="/books/react/assets/img/ad-logo.svg">
				<p class="ad-title">å‡¹è„‘å›¾</p>
			</div>
			<p class="ad-wording">è¿„ä»Šä¸ºæ­¢æœ€ç®€å•å¥½ç”¨çš„åœ¨çº¿æ€ç»´å¯¼å›¾å·¥å…·</p>
			<span class="ad-indicator">å¹¿å‘Š</span>
			<img src="/books/react/assets/img/ad-bg-2.svg" class="ad-bg-2">
		</a> -->
		<!-- <div class='share-block margin-top-gap'>
			<p>å¦‚æœä½ è§‰å¾—å°ä¹¦å†™å¾—è¿˜ä¸é”™ï¼Œå¯ä»¥è¯·èƒ¡å­å¤§å“ˆå–æ¯èŒ¶ :)</p>
			<button class='donate-button' id='donate-button' type="button">èµèµ</button>
		</div> -->
		<div class='share-block margin-bottom-gap'>
			<p>ä¼ æ’­ä¸€ä¸‹çŸ¥è¯†ä¹Ÿæ˜¯ä¸€ä¸ªå¾ˆå¥½çš„é€‰æ‹©</p>
			<div class="share-block-inner">
				<div class="jiathis_style_24x24">
					<a class="jiathis_button_qzone"></a>
					<a class="jiathis_button_tsina"></a>
					<a class="jiathis_button_tqq"></a>
					<a class="jiathis_button_weixin"></a>
					<a class="jiathis_button_renren"></a>
					<a href="javascript:if(confirm('http://www.jiathis.com/share?uid=2127727  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='http://www.jiathis.com/share?uid=2127727'" tppabs="http://www.jiathis.com/share?uid=2127727" class="jiathis jiathis_txt jtico jtico_jiathis" target="_blank"></a>
				</div>
				<script type="text/javascript">
				var jiathis_config = {data_track_clickback:'true'};
				</script>
				<script type="text/javascript" src="../../../v3.jiathis.com/code/jia.js-uid=2127727" tppabs="http://v3.jiathis.com/code/jia.js?uid=2127727" charset="utf-8"></script>
			</div>
		</div>
		<!-- UY BEGIN -->
		<div id="uyan_frame"></div>
		<script type="text/javascript">
		var paths = window.location.pathname.split('/')
		var lessonName = paths[paths.length - 1]
		var uyan_config = {
			// 'url': 'http://react.huziketang.com/blog/' + lessonName,
			'du': 'http://huziketang.com/books/react/react.huziketang.com'
		}
		</script>
		<script type="text/javascript" src="../../../v2.uyan.cc/code/uyan.js-uid=2127727" tppabs="http://v2.uyan.cc/code/uyan.js?uid=2127727"></script>
		<!-- UY END -->
		<!--wechat donate-->
		<div class='donate-mask' id='donate-mask'>
			<img src="../../../huzidaha.github.io/static/assets/img/wechat-pay.png" tppabs="https://huzidaha.github.io/static/assets/img/wechat-pay.png" id='wechat-pay' />
		</div>
		<script type="text/javascript">
			// var donateMask = document.getElementById('donate-mask')
			// var donateButton = document.getElementById('donate-button')
			// var wechatPay = document.getElementById('wechat-pay')
			// donateButton.addEventListener('click', function () {
			// 	donateMask.style.display = 'flex'
			// }, false)
			// donateMask.addEventListener('click', function () {
			// 	donateMask.style.display = 'none'
			// }, false)
			// wechatPay.addEventListener('click', function (event) {
			// 	event.stopPropagation()
			// }, false)
		</script>
	</div>

    </div>
    <script src="assets/js/highlight.js" tppabs="http://huziketang.com/books/react/assets/js/highlight.js"></script>
    <script>
    var _hmt = _hmt || [];
    (function() {
      if (window.location.origin.match(/localhost/)) return
      var hm = document.createElement("script");
      hm.src = "../../../hm.baidu.com/hm.js-f08b5240ef2d1692572ce0f7756b325e"/*tpa=https://hm.baidu.com/hm.js?f08b5240ef2d1692572ce0f7756b325e*/;
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
      var bp = document.createElement('script');
      // push baidu.com
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
        bp.src = '../../../zz.bdstatic.com/linksubmit/push.js'/*tpa=https://zz.bdstatic.com/linksubmit/push.js*/;
      }
      else {
        bp.src = '../../../push.zhanzhang.baidu.com/push.js'/*tpa=http://push.zhanzhang.baidu.com/push.js*/;
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
    })();
    // var wrapper = document.getElementById('wrapper')
    // var floatWechat = document.getElementById('float-wechat')

    // function resetAll (event) {
    //   var rect = wrapper.getBoundingClientRect()
    //   resetFloatWechat(rect)
    // }
    // function resetFloatWechat(rect) {
    //   var left = rect.left + rect.width
    //   floatWechat.style.left = left + 'px'
    //   floatWechat.style.display = 'block'
    // }
    // window.addEventListener('resize', resetAll)
    // resetAll()
    </script>

</body>

</html>
