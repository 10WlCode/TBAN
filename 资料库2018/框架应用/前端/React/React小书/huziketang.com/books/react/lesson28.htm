<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="baidu-site-verification" content="GNvdsbNFPS" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    
      <title>é«˜é˜¶ç»„ä»¶ï¼ˆHigher-Order Componentsï¼‰ | React.js å°ä¹¦</title>
      <meta name="keywords" content="React.js,React.js å°ä¹¦,é«˜é˜¶ç»„ä»¶,å®æˆ˜" />
      <meta name="description" content="React.js å°ä¹¦æ˜¯ä¸€ä¸ªå¼€æºã€å…è´¹ã€ä¸“ä¸šã€ç®€å•çš„ React.js æ•™ç¨‹ã€‚React.js ä¸­çš„é«˜é˜¶ç»„ä»¶å°±æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œä¼ ç»™å®ƒä¸€ä¸ªç»„ä»¶ï¼Œå®ƒè¿”å›ä¸€ä¸ªæ–°çš„ç»„ä»¶ã€‚æ³¨æ„ï¼Œé«˜é˜¶å‡½æ•°æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œè€Œä¸æ˜¯ç»„ä»¶ã€‚" />
    

    

    <link rel="icon" href="https://huzidaha.github.io/static/assets/img/favicon.ico">
    <link rel="stylesheet"
href="../../../fonts.googleapis.com/css-family=Inconsolata-400,700.css" tppabs="https://fonts.googleapis.com/css?family=Inconsolata:400,700">
    <link rel="stylesheet" type="text/css" href="assets/css/main.css" tppabs="http://huziketang.com/books/react/assets/css/main.css">
</head>

<body>

    <!-- <div class='float-wechat' id='float-wechat'>
    	<img src='https://huzidaha.github.io/static/assets/img/wechat-user.jpeg' />
      <p>åŠ å…¥ã€ŠReact.js å°ä¹¦ã€‹è¯»è€…äº¤æµç¾¤ï¼Œä¸€èµ·è®¨è®ºã€äº¤æµã€å­¦ä¹ å‰ç«¯æŠ€æœ¯ã€‚</p>
    </div> -->
    <div class="wrapper" id='wrapper'>
      <style media="screen">
@media (max-width: 1335px) and (min-width: 900px) {
	.wrapper {
		margin-left: 329px;
	}
}
@media (max-width: 900px) {
	#table-of-content {
		margin-left: -350px;
	}
}
</style>
<h1 style='position: relative; top: -15px;'>React.js å°ä¹¦</h1>

<link ref='prefetch' href="/books/react/lesson29" />


<nav class='table-of-content' id='table-of-content'>
	<a href="javascript:if(confirm('http://huziketang.com/books/react  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='http://huziketang.com/books/react'" tppabs="http://huziketang.com/books/react">&lt;-- é¦–é¡µ</a>
	<h3>ç¬¬ä¸€é˜¶æ®µ</h3>
  
  
		<a  href="lesson1.htm" tppabs="http://huziketang.com/books/react/lesson1" title="React.js ç®€ä»‹">1. React.js ç®€ä»‹</a>
  
  
  
		<a  href="lesson2.htm" tppabs="http://huziketang.com/books/react/lesson2" title="å‰ç«¯ç»„ä»¶åŒ–ï¼ˆä¸€ï¼‰ï¼šä»ä¸€ä¸ªç®€å•çš„ä¾‹å­è®²èµ·">2. å‰ç«¯ç»„ä»¶åŒ–ï¼ˆä¸€ï¼‰ï¼šä»ä¸€ä¸ªç®€å•çš„ä¾‹å­è®²èµ·</a>
  
  
  
		<a  href="lesson3.htm" tppabs="http://huziketang.com/books/react/lesson3" title="å‰ç«¯ç»„ä»¶åŒ–ï¼ˆäºŒï¼‰ï¼šä¼˜åŒ– DOM æ“ä½œ">3. å‰ç«¯ç»„ä»¶åŒ–ï¼ˆäºŒï¼‰ï¼šä¼˜åŒ– DOM æ“ä½œ</a>
  
  
  
		<a  href="lesson4.htm" tppabs="http://huziketang.com/books/react/lesson4" title="å‰ç«¯ç»„ä»¶åŒ–ï¼ˆä¸‰ï¼‰ï¼šæŠ½è±¡å‡ºå…¬å…±ç»„ä»¶ç±»">4. å‰ç«¯ç»„ä»¶åŒ–ï¼ˆä¸‰ï¼‰ï¼šæŠ½è±¡å‡ºå…¬å…±ç»„ä»¶ç±»</a>
  
  
  
		<a  href="lesson5.htm" tppabs="http://huziketang.com/books/react/lesson5" title="React.js åŸºæœ¬ç¯å¢ƒå®‰è£…">5. React.js åŸºæœ¬ç¯å¢ƒå®‰è£…</a>
  
  
  
		<a  href="lesson6.htm" tppabs="http://huziketang.com/books/react/lesson6" title="ä½¿ç”¨ JSX æè¿° UI ä¿¡æ¯">6. ä½¿ç”¨ JSX æè¿° UI ä¿¡æ¯</a>
  
  
  
		<a  href="lesson7.htm" tppabs="http://huziketang.com/books/react/lesson7" title="ç»„ä»¶çš„ render æ–¹æ³•">7. ç»„ä»¶çš„ render æ–¹æ³•</a>
  
  
  
		<a  href="lesson8.htm" tppabs="http://huziketang.com/books/react/lesson8" title="ç»„ä»¶çš„ç»„åˆã€åµŒå¥—å’Œç»„ä»¶æ ‘">8. ç»„ä»¶çš„ç»„åˆã€åµŒå¥—å’Œç»„ä»¶æ ‘</a>
  
  
  
		<a  href="lesson9.htm" tppabs="http://huziketang.com/books/react/lesson9" title="äº‹ä»¶ç›‘å¬">9. äº‹ä»¶ç›‘å¬</a>
  
  
  
		<a  href="lesson10.htm" tppabs="http://huziketang.com/books/react/lesson10" title="ç»„ä»¶çš„ state å’Œ setState">10. ç»„ä»¶çš„ state å’Œ setState</a>
  
  
  
		<a  href="lesson11.htm" tppabs="http://huziketang.com/books/react/lesson11" title="é…ç½®ç»„ä»¶çš„ props">11. é…ç½®ç»„ä»¶çš„ props</a>
  
  
  
		<a  href="lesson12.htm" tppabs="http://huziketang.com/books/react/lesson12" title="state vs props">12. state vs props</a>
  
  
  
		<a  href="lesson13.htm" tppabs="http://huziketang.com/books/react/lesson13" title="æ¸²æŸ“åˆ—è¡¨æ•°æ®">13. æ¸²æŸ“åˆ—è¡¨æ•°æ®</a>
  
  
  
		<a  href="lesson14.htm" tppabs="http://huziketang.com/books/react/lesson14" title="å®æˆ˜åˆ†æï¼šè¯„è®ºåŠŸèƒ½ï¼ˆä¸€ï¼‰">14. å®æˆ˜åˆ†æï¼šè¯„è®ºåŠŸèƒ½ï¼ˆä¸€ï¼‰</a>
  
  
  
		<a  href="lesson15.htm" tppabs="http://huziketang.com/books/react/lesson15" title="å®æˆ˜åˆ†æï¼šè¯„è®ºåŠŸèƒ½ï¼ˆäºŒï¼‰">15. å®æˆ˜åˆ†æï¼šè¯„è®ºåŠŸèƒ½ï¼ˆäºŒï¼‰</a>
  
  
  
		<a  href="lesson16.htm" tppabs="http://huziketang.com/books/react/lesson16" title="å®æˆ˜åˆ†æï¼šè¯„è®ºåŠŸèƒ½ï¼ˆä¸‰ï¼‰">16. å®æˆ˜åˆ†æï¼šè¯„è®ºåŠŸèƒ½ï¼ˆä¸‰ï¼‰</a>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
	<h3>ç¬¬äºŒé˜¶æ®µ</h3>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
		<a  href="lesson17.htm" tppabs="http://huziketang.com/books/react/lesson17" title="å‰ç«¯åº”ç”¨çŠ¶æ€ç®¡ç† â€”â€” çŠ¶æ€æå‡">17. å‰ç«¯åº”ç”¨çŠ¶æ€ç®¡ç† â€”â€” çŠ¶æ€æå‡</a>
  
  
  
		<a  href="lesson18.htm" tppabs="http://huziketang.com/books/react/lesson18" title="æŒ‚è½½é˜¶æ®µçš„ç»„ä»¶ç”Ÿå‘½å‘¨æœŸï¼ˆä¸€ï¼‰">18. æŒ‚è½½é˜¶æ®µçš„ç»„ä»¶ç”Ÿå‘½å‘¨æœŸï¼ˆä¸€ï¼‰</a>
  
  
  
		<a  href="lesson19.htm" tppabs="http://huziketang.com/books/react/lesson19" title="æŒ‚è½½é˜¶æ®µçš„ç»„ä»¶ç”Ÿå‘½å‘¨æœŸï¼ˆäºŒï¼‰">19. æŒ‚è½½é˜¶æ®µçš„ç»„ä»¶ç”Ÿå‘½å‘¨æœŸï¼ˆäºŒï¼‰</a>
  
  
  
		<a  href="lesson20.htm" tppabs="http://huziketang.com/books/react/lesson20" title="æ›´æ–°é˜¶æ®µçš„ç»„ä»¶ç”Ÿå‘½å‘¨æœŸ">20. æ›´æ–°é˜¶æ®µçš„ç»„ä»¶ç”Ÿå‘½å‘¨æœŸ</a>
  
  
  
		<a  href="lesson21.htm" tppabs="http://huziketang.com/books/react/lesson21" title="ref å’Œ React.js ä¸­çš„ DOM æ“ä½œ">21. ref å’Œ React.js ä¸­çš„ DOM æ“ä½œ</a>
  
  
  
		<a  href="lesson22.htm" tppabs="http://huziketang.com/books/react/lesson22" title="props.children å’Œå®¹å™¨ç±»ç»„ä»¶">22. props.children å’Œå®¹å™¨ç±»ç»„ä»¶</a>
  
  
  
		<a  href="lesson23.htm" tppabs="http://huziketang.com/books/react/lesson23" title="dangerouslySetHTML å’Œ style å±æ€§">23. dangerouslySetHTML å’Œ style å±æ€§</a>
  
  
  
		<a  href="lesson24.htm" tppabs="http://huziketang.com/books/react/lesson24" title="PropTypes å’Œç»„ä»¶å‚æ•°éªŒè¯">24. PropTypes å’Œç»„ä»¶å‚æ•°éªŒè¯</a>
  
  
  
		<a  href="lesson25.htm" tppabs="http://huziketang.com/books/react/lesson25" title="å®æˆ˜åˆ†æï¼šè¯„è®ºåŠŸèƒ½ï¼ˆå››ï¼‰">25. å®æˆ˜åˆ†æï¼šè¯„è®ºåŠŸèƒ½ï¼ˆå››ï¼‰</a>
  
  
  
		<a  href="lesson26.htm" tppabs="http://huziketang.com/books/react/lesson26" title="å®æˆ˜åˆ†æï¼šè¯„è®ºåŠŸèƒ½ï¼ˆäº”ï¼‰">26. å®æˆ˜åˆ†æï¼šè¯„è®ºåŠŸèƒ½ï¼ˆäº”ï¼‰</a>
  
  
  
		<a  href="lesson27.htm" tppabs="http://huziketang.com/books/react/lesson27" title="å®æˆ˜åˆ†æï¼šè¯„è®ºåŠŸèƒ½ï¼ˆå…­ï¼‰">27. å®æˆ˜åˆ†æï¼šè¯„è®ºåŠŸèƒ½ï¼ˆå…­ï¼‰</a>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
	<h3>ç¬¬ä¸‰é˜¶æ®µ</h3>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
		<a  class='active'  href="lesson28.htm" tppabs="http://huziketang.com/books/react/lesson28" title="é«˜é˜¶ç»„ä»¶ï¼ˆHigher-Order Componentsï¼‰">28. é«˜é˜¶ç»„ä»¶ï¼ˆHigher-Order Componentsï¼‰</a>
  
  
  
		<a  href="lesson29.htm" tppabs="http://huziketang.com/books/react/lesson29" title="React.js çš„ context">29. React.js çš„ context</a>
  
  
  
		<a  href="lesson30.htm" tppabs="http://huziketang.com/books/react/lesson30" title="åŠ¨æ‰‹å®ç° Reduxï¼ˆä¸€ï¼‰ï¼šä¼˜é›…åœ°ä¿®æ”¹å…±äº«çŠ¶æ€">30. åŠ¨æ‰‹å®ç° Reduxï¼ˆä¸€ï¼‰ï¼šä¼˜é›…åœ°ä¿®æ”¹å…±äº«çŠ¶æ€</a>
  
  
  
		<a  href="lesson31.htm" tppabs="http://huziketang.com/books/react/lesson31" title="åŠ¨æ‰‹å®ç° Reduxï¼ˆäºŒï¼‰ï¼šæŠ½ç¦» store å’Œç›‘æ§æ•°æ®å˜åŒ–">31. åŠ¨æ‰‹å®ç° Reduxï¼ˆäºŒï¼‰ï¼šæŠ½ç¦» store å’Œç›‘æ§æ•°æ®å˜åŒ–</a>
  
  
  
		<a  href="lesson32.htm" tppabs="http://huziketang.com/books/react/lesson32" title="åŠ¨æ‰‹å®ç° Reduxï¼ˆä¸‰ï¼‰ï¼šçº¯å‡½æ•°ï¼ˆPure Functionï¼‰ç®€ä»‹">32. åŠ¨æ‰‹å®ç° Reduxï¼ˆä¸‰ï¼‰ï¼šçº¯å‡½æ•°ï¼ˆPure Functionï¼‰ç®€ä»‹</a>
  
  
  
		<a  href="lesson33.htm" tppabs="http://huziketang.com/books/react/lesson33" title="åŠ¨æ‰‹å®ç° Reduxï¼ˆå››ï¼‰ï¼šå…±äº«ç»“æ„çš„å¯¹è±¡æé«˜æ€§èƒ½">33. åŠ¨æ‰‹å®ç° Reduxï¼ˆå››ï¼‰ï¼šå…±äº«ç»“æ„çš„å¯¹è±¡æé«˜æ€§èƒ½</a>
  
  
  
		<a  href="lesson34.htm" tppabs="http://huziketang.com/books/react/lesson34" title="åŠ¨æ‰‹å®ç° Reduxï¼ˆäº”ï¼‰ï¼šä¸è¦é—®ä¸ºä»€ä¹ˆçš„ reducer">34. åŠ¨æ‰‹å®ç° Reduxï¼ˆäº”ï¼‰ï¼šä¸è¦é—®ä¸ºä»€ä¹ˆçš„ reducer</a>
  
  
  
		<a  href="lesson35.htm" tppabs="http://huziketang.com/books/react/lesson35" title="åŠ¨æ‰‹å®ç° Reduxï¼ˆå…­ï¼‰ï¼šRedux æ€»ç»“">35. åŠ¨æ‰‹å®ç° Reduxï¼ˆå…­ï¼‰ï¼šRedux æ€»ç»“</a>
  
  
  
		<a  href="lesson36.htm" tppabs="http://huziketang.com/books/react/lesson36" title="åŠ¨æ‰‹å®ç° React-reduxï¼ˆä¸€ï¼‰ï¼šåˆå§‹åŒ–å·¥ç¨‹">36. åŠ¨æ‰‹å®ç° React-reduxï¼ˆä¸€ï¼‰ï¼šåˆå§‹åŒ–å·¥ç¨‹</a>
  
  
  
		<a  href="lesson37.htm" tppabs="http://huziketang.com/books/react/lesson37" title="åŠ¨æ‰‹å®ç° React-reduxï¼ˆäºŒï¼‰ï¼šç»“åˆ context å’Œ store">37. åŠ¨æ‰‹å®ç° React-reduxï¼ˆäºŒï¼‰ï¼šç»“åˆ context å’Œ store</a>
  
  
  
		<a  href="lesson38.htm" tppabs="http://huziketang.com/books/react/lesson38" title="åŠ¨æ‰‹å®ç° React-reduxï¼ˆä¸‰ï¼‰ï¼šconnect å’Œ mapStateToProps">38. åŠ¨æ‰‹å®ç° React-reduxï¼ˆä¸‰ï¼‰ï¼šconnect å’Œ mapStateToProps</a>
  
  
  
		<a  href="lesson39.htm" tppabs="http://huziketang.com/books/react/lesson39" title="åŠ¨æ‰‹å®ç° React-reduxï¼ˆå››ï¼‰ï¼šmapDispatchToProps">39. åŠ¨æ‰‹å®ç° React-reduxï¼ˆå››ï¼‰ï¼šmapDispatchToProps</a>
  
  
  
		<a  href="lesson40.htm" tppabs="http://huziketang.com/books/react/lesson40" title="åŠ¨æ‰‹å®ç° React-reduxï¼ˆäº”ï¼‰ï¼šProvider">40. åŠ¨æ‰‹å®ç° React-reduxï¼ˆäº”ï¼‰ï¼šProvider</a>
  
  
  
		<a  href="lesson41.htm" tppabs="http://huziketang.com/books/react/lesson41" title="åŠ¨æ‰‹å®ç° React-reduxï¼ˆå…­ï¼‰ï¼šReact-redux æ€»ç»“">41. åŠ¨æ‰‹å®ç° React-reduxï¼ˆå…­ï¼‰ï¼šReact-redux æ€»ç»“</a>
  
  
  
		<a  href="lesson42.htm" tppabs="http://huziketang.com/books/react/lesson42" title="ä½¿ç”¨çœŸæ­£çš„ Redux å’Œ React-redux">42. ä½¿ç”¨çœŸæ­£çš„ Redux å’Œ React-redux</a>
  
  
  
		<a  href="lesson43.htm" tppabs="http://huziketang.com/books/react/lesson43" title="Smart ç»„ä»¶ vs Dumb ç»„ä»¶">43. Smart ç»„ä»¶ vs Dumb ç»„ä»¶</a>
  
  
  
		<a  href="lesson44.htm" tppabs="http://huziketang.com/books/react/lesson44" title="å®æˆ˜åˆ†æï¼šè¯„è®ºåŠŸèƒ½ï¼ˆä¸ƒï¼‰">44. å®æˆ˜åˆ†æï¼šè¯„è®ºåŠŸèƒ½ï¼ˆä¸ƒï¼‰</a>
  
  
  
		<a  href="lesson45.htm" tppabs="http://huziketang.com/books/react/lesson45" title="å®æˆ˜åˆ†æï¼šè¯„è®ºåŠŸèƒ½ï¼ˆå…«ï¼‰">45. å®æˆ˜åˆ†æï¼šè¯„è®ºåŠŸèƒ½ï¼ˆå…«ï¼‰</a>
  
  
  
		<a  href="lesson46.htm" tppabs="http://huziketang.com/books/react/lesson46" title="å®æˆ˜åˆ†æï¼šè¯„è®ºåŠŸèƒ½ï¼ˆä¹ï¼‰">46. å®æˆ˜åˆ†æï¼šè¯„è®ºåŠŸèƒ½ï¼ˆä¹ï¼‰</a>
  
  
</nav>
<div id="mask-template">
	<div></div>
</div>
<style>
	#granted-modal {
		display: none;
		position: fixed;
		margin: auto;
		left: 100px;
		top: 0;
		bottom: 100px;
		right: 0;
		width: 500px;
		height: 300px;
		background: #fff;
		z-index: 100;
		border-radius: 5px;
	}
	#try-to-buy {
		display: none;
	}
	.error-message {
    position: absolute;
    bottom: 7px;
    right: -30px;
    font-size: 12px;
    color: rgb(211, 53, 62);
  }
	.field {
		position: relative;
		margin-top: 25px;
	}
	.modal-head {
		font-size: 20px;
    text-align: center;
    margin-top: 30px;
	}
	.granted-footer {
		text-align: center;
	}
	#back-to-input {
		font-size: 12px;
    position: absolute;
    top: 10px;
    left: 15px;
	}
	.hover {
		cursor: pointer;
	}
	.granted-footer {
		position: absolute;
    margin: auto;
		padding-top: 15px;
    left: 30px;
    right: 30px;
    bottom: 20px;
		border-top: 1px solid #eee;
	}
	#buy-now {
		color: #00a854;
	}
	.field label {
		display: inline-block;
		width: 90px;
		text-align: right;
	}
	.field label::after {
		content: "ï¼š"
	}
	.granted-form {
		width: 80%;
		margin: 0 auto;
		margin-top: 25px;
	}
	.submit {
		display: inline-block;
		float: right;
	}
	.button {
		background: #f7f7f7;
		border: 1px solid #ccc;
		padding: 5px 20px;
		border-radius: 3px;
		outline: none;
	}
	.button:hover {
		background: #fff;
	}
	.field input {
    padding: 6px 10px;
    border-radius: 4px;
    border: 1px solid #e0dbdb;
    width: 166px;
	}
</style>
<div id="granted-modal">
	<div style="padding: 10px;">
		<div id="readcode-input-area">
			<h2 class="modal-head">é˜…è¯»ç¬¬ä¸‰é˜¶æ®µï¼Œè¯·è¾“å…¥ä½ çš„é˜…è¯»ç  </h2>
			<form class="granted-form" id="read-code-form">
				<div class="field">
					<label>Email</label>
					<input type="email" id="email">
				</div>
				<div class="field">
					<label>é˜…è¯»ç </label>
					<input type="text" id="read-code">
				</div>
				<button id="check-granted" class="button hover submit">ç¡®è®¤</button>
			</form>
			<div class="granted-footer">
				è¿˜æ²¡æœ‰é˜…è¯»ç ï¼Ÿ<b>Â¥10</b> å…ƒå³å¯é˜…è¯»æ‰€æœ‰ç« èŠ‚
				<p style="margin-top: 10px;"><a class="hover" id="buy-now">é©¬ä¸Šè·å–é˜…è¯»ç </a></p>
			</div>
		</div>
		<div id="try-to-buy">
			<div id="back-to-input" class="hover">&lt;&lt; è¿”å›</div>
			<h2 class="modal-head">è¾“å…¥ä½ çš„é‚®ç®±ï¼Œç³»ç»Ÿä¼šç»™ä½ å‘é€é‚®ä»¶</h2>
			<form class="granted-form" id="get-read-code-form">
				<div class="field">
					<label>Email</label>
					<input type="email" id="reader-email">
				</div>
				<button id="alipay" style="margin-top: 20px;" class="hover submit button">è·å–é˜…è¯»ç </button>
			</form>
		</div>
	</div>
</div>
<script src="assets/js/jquery-3.2.1.min.js" tppabs="http://huziketang.com/books/react/assets/js/jquery-3.2.1.min.js"></script>
<script src="assets/js/pay.min.js" tppabs="http://huziketang.com/books/react/assets/js/pay.min.js"></script>
<script type="text/javascript">
var tableOfContent = document.getElementById('table-of-content')
var timer = null
function resetTableOfContent (rect) {
  scrollTop = localStorage.getItem('scrollTop') * 1
  scrollTop = scrollTop || 0
  tableOfContent.scrollTop = scrollTop
}
tableOfContent.addEventListener('scroll', function (event) {
  clearTimeout(timer)
  timer = setTimeout(function() {
    localStorage.setItem('scrollTop', tableOfContent.scrollTop)
  }, 50)
}, false)
resetTableOfContent()
</script>
<div class="post">
	<div class="post__back">
  	<a href="javascript:if(confirm('http://huziketang.com/books/react  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='http://huziketang.com/books/react'" tppabs="http://huziketang.com/books/react">&lt;-- è¿”å›é¦–é¡µ</a>
    <div class="post__title">
    	<h1>é«˜é˜¶ç»„ä»¶ï¼ˆHigher-Order Componentsï¼‰</h1>
    </div>
    <div class="post__meta">
    	<p></p>
    </div>
    <div class="post__content"?>
      <ul style="font-size: 14px; margin-top: -10px;">
  <li>
    ä½œè€…ï¼š<a href="javascript:if(confirm('https://www.zhihu.com/people/hu-zi-da-ha  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://www.zhihu.com/people/hu-zi-da-ha'" tppabs="https://www.zhihu.com/people/hu-zi-da-ha" target="_blank">èƒ¡å­å¤§å“ˆ</a>
  </li>
  <li>
    åŸæ–‡é“¾æ¥ï¼š<a href="lesson28.htm" tppabs="http://huziketang.com/books/react/lesson28"> http://huziketang.com/books/react/lesson28 </a>
  </li>
  <li>è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼Œä¿ç•™åŸæ–‡é“¾æ¥å’Œä½œè€…ä¿¡æ¯ã€‚</li>
</ul>

<p>ï¼ˆæœ¬æ–‡æœªå®¡æ ¸ï¼‰</p>

<p>æœ‰æ—¶å€™äººä»¬å¾ˆå–œæ¬¢é€ ä¸€äº›åå­—å¾ˆå“äººçš„åè¯ï¼Œè®©äººä¸€å¬è¿™ä¸ªåè¯å°±è§‰å¾—è‡ªå·±ä¸å¯èƒ½å­¦ä¼šï¼Œä»è€Œè®©äººæœ›è€Œå´æ­¥ã€‚ä½†æ˜¯å…¶å®è¿™äº›åè¯èƒŒåæ‰€ä»£è¡¨çš„ä¸œè¥¿å…¶å®å¾ˆç®€å•ã€‚</p>

<p>æˆ‘ä¸èƒ½è¯´é«˜é˜¶ç»„ä»¶å°±æ˜¯è¿™ä¹ˆä¸€ä¸ªä¸œè¥¿ã€‚ä½†æ˜¯å®ƒæ˜¯ä¸€ä¸ªæ¦‚å¿µä¸Šå¾ˆç®€å•ï¼Œä½†å´éå¸¸å¸¸ç”¨ã€å®ç”¨çš„ä¸œè¥¿ï¼Œè¢«å¤§é‡ React.js ç›¸å…³çš„ç¬¬ä¸‰æ–¹åº“é¢‘ç¹åœ°ä½¿ç”¨ã€‚åœ¨å‰ç«¯çš„ä¸šåŠ¡å¼€å‘å½“ä¸­ï¼Œä½ ä¸æŒæ¡é«˜é˜¶ç»„ä»¶å…¶å®ä¹Ÿå¯ä»¥å®Œæˆé¡¹ç›®çš„å¼€å‘ï¼Œä½†æ˜¯å¦‚æœä½ èƒ½å¤Ÿçµæ´»åœ°ä½¿ç”¨é«˜é˜¶ç»„ä»¶ï¼Œå¯ä»¥è®©ä½ ä»£ç æ›´åŠ ä¼˜é›…ï¼Œå¤ç”¨æ€§ã€çµæ´»æ€§æ›´å¼ºã€‚å®ƒæ˜¯ä¸€ä¸ªåŠ åˆ†é¡¹ï¼Œè€Œä¸”åŠ çš„åˆ†è¿˜ä¸å°‘ã€‚</p>

<p>æœ¬ç« èŠ‚å¯èƒ½æœ‰éƒ¨åˆ†å†…å®¹ç†è§£èµ·æ¥ä¼šæœ‰éš¾åº¦ï¼Œå¦‚æœä½ è§‰å¾—æ— æ³•å®Œå…¨ç†è§£æœ¬èŠ‚å†…å®¹ã€‚å¯ä»¥å…ˆç®€å•ç†è§£é«˜é˜¶ç»„ä»¶çš„æ¦‚å¿µå’Œä½œç”¨å³å¯ï¼Œå…¶ä»–å†…å®¹é€‰æ‹©æ€§åœ°è·³è¿‡ã€‚</p>

<p>äº†è§£é«˜é˜¶ç»„ä»¶å¯¹æˆ‘ä»¬ç†è§£å„ç§ React.js ç¬¬ä¸‰æ–¹åº“çš„åŸç†å¾ˆæœ‰å¸®åŠ©ã€‚</p>

<h2 id="ä»€ä¹ˆæ˜¯é«˜é˜¶ç»„ä»¶">ä»€ä¹ˆæ˜¯é«˜é˜¶ç»„ä»¶</h2>
<p><em>é«˜é˜¶ç»„ä»¶å°±æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œä¼ ç»™å®ƒä¸€ä¸ªç»„ä»¶ï¼Œå®ƒè¿”å›ä¸€ä¸ªæ–°çš„ç»„ä»¶ã€‚</em></p>

<pre><code class="language-javascript">const NewComponent = higherOrderComponent(OldComponent)
</code></pre>

<p>é‡è¦çš„äº‹æƒ…å†é‡å¤ä¸€æ¬¡ï¼Œé«˜é˜¶ç»„ä»¶æ˜¯ä¸€ä¸ªå‡½æ•°ï¼ˆè€Œä¸æ˜¯ç»„ä»¶ï¼‰ï¼Œå®ƒæ¥å—ä¸€ä¸ªç»„ä»¶ä½œä¸ºå‚æ•°ï¼Œè¿”å›ä¸€ä¸ªæ–°çš„ç»„ä»¶ã€‚è¿™ä¸ªæ–°çš„ç»„ä»¶ä¼šä½¿ç”¨ä½ ä¼ ç»™å®ƒçš„ç»„ä»¶ä½œä¸ºå­ç»„ä»¶ï¼Œæˆ‘ä»¬çœ‹çœ‹ä¸€ä¸ªå¾ˆç®€å•çš„é«˜é˜¶ç»„ä»¶ï¼š</p>

<pre><code class="language-javascript">import React, { Component } from 'react'

export default (WrappedComponent) =&gt; {
  class NewComponent extends Component {
    // å¯ä»¥åšå¾ˆå¤šè‡ªå®šä¹‰é€»è¾‘
    render () {
      return &lt;WrappedComponent /&gt;
    }
  }
  return NewComponent
}
</code></pre>

<p>ç°åœ¨çœ‹æ¥å¥½åƒä»€ä¹ˆç”¨éƒ½æ²¡æœ‰ï¼Œå®ƒå°±æ˜¯ç®€å•çš„æ„å»ºäº†ä¸€ä¸ªæ–°çš„ç»„ä»¶ç±» <code>NewComponent</code>ï¼Œç„¶åæŠŠä¼ è¿›å…¥å»çš„ <code>WrappedComponent</code> æ¸²æŸ“å‡ºæ¥ã€‚ä½†æ˜¯æˆ‘ä»¬å¯ä»¥ç»™ <code>NewCompoent</code> åšä¸€äº›æ•°æ®å¯åŠ¨å·¥ä½œï¼š</p>

<pre><code class="language-javascript">import React, { Component } from 'react'

export default (WrappedComponent, name) =&gt; {
  class NewComponent extends Component {
    constructor () {
      super()
      this.state = { data: null }
    }

    componentWillMount () {
      let data = localStorage.getItem(name)
      this.setState({ data })
    }

    render () {
      return &lt;WrappedComponent data={this.state.data} /&gt;
    }
  }
  return NewComponent
}
</code></pre>

<p>ç°åœ¨ <code>NewComponent</code> ä¼šæ ¹æ®ç¬¬äºŒä¸ªå‚æ•° <code>name</code> åœ¨æŒ‚è½½é˜¶æ®µä» LocalStorage åŠ è½½æ•°æ®ï¼Œå¹¶ä¸” <code>setState</code> åˆ°è‡ªå·±çš„ <code>state.data</code> ä¸­ï¼Œè€Œæ¸²æŸ“çš„æ—¶å€™å°† <code>state.data</code> é€šè¿‡ <code>props.data</code> ä¼ ç»™ <code>WrappedComponent</code>ã€‚</p>

<p>è¿™ä¸ªé«˜é˜¶ç»„ä»¶æœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿå‡è®¾ä¸Šé¢çš„ä»£ç æ˜¯åœ¨ <code>src/wrapWithLoadData.js</code> æ–‡ä»¶ä¸­çš„ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨åˆ«çš„åœ°æ–¹è¿™ä¹ˆç”¨å®ƒï¼š</p>

<pre><code class="language-javascript">import wrapWithLoadData from './wrapWithLoadData'

class InputWithUserName extends Component {
  render () {
    return &lt;input value={this.props.data} /&gt;
  }
}

InputWithUserName = wrapWithLoadData(InputWithUserName, 'username')
export default InputWithUserName
</code></pre>

<p>å‡å¦‚ <code>InputWithUserName</code> çš„åŠŸèƒ½éœ€æ±‚æ˜¯æŒ‚è½½çš„æ—¶å€™ä» LocalStorage é‡Œé¢åŠ è½½ <code>username</code> å­—æ®µä½œä¸º <code>&lt;input /&gt;</code> çš„ <code>value</code> å€¼ï¼Œç°åœ¨æœ‰äº† <code>wrapWithLoadData</code>ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“åœ°åšåˆ°è¿™ä»¶äº‹æƒ…ã€‚</p>

<p>åªéœ€è¦å®šä¹‰ä¸€ä¸ªéå¸¸ç®€å•çš„ <code>InputWithUserName</code>ï¼Œå®ƒä¼šæŠŠ <code>props.data</code> ä½œä¸º <code>&lt;input /&gt;</code> çš„ <code>value</code> å€¼ã€‚ç„¶æŠŠè¿™ä¸ªç»„ä»¶å’Œ <code>'username'</code> ä¼ ç»™ <code>wrapWithLoadData</code>ï¼Œ<code>wrapWithLoadData</code> ä¼šè¿”å›ä¸€ä¸ªæ–°çš„ç»„ä»¶ï¼Œæˆ‘ä»¬ç”¨è¿™ä¸ªæ–°çš„ç»„ä»¶è¦†ç›–åŸæ¥çš„ <code>InputWithUserName</code>ï¼Œç„¶åå†å¯¼å‡ºå»æ¨¡å—ã€‚</p>

<p>åˆ«äººç”¨è¿™ä¸ªç»„ä»¶çš„æ—¶å€™å®é™…æ˜¯ç”¨äº†<em>è¢«åŠ å·¥è¿‡</em>çš„ç»„ä»¶ï¼š</p>

<pre><code class="language-javascript">import InputWithUserName from './InputWithUserName'

class Index extends Component {
  render () {
    return (
      &lt;div&gt;
        ç”¨æˆ·åï¼š&lt;InputWithUserName /&gt;
      &lt;/div&gt;
    )
  }
}
</code></pre>

<p>æ ¹æ® <code>wrapWithLoadData</code> çš„ä»£ç æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œè¿™ä¸ªæ–°çš„ç»„ä»¶æŒ‚è½½çš„æ—¶å€™ä¼šå…ˆå» LocalStorage åŠ è½½æ•°æ®ï¼Œæ¸²æŸ“çš„æ—¶å€™å†é€šè¿‡ <code>props.data</code> ä¼ ç»™çœŸæ­£çš„ <code>InputWithUserName</code>ã€‚</p>

<p>å¦‚æœç°åœ¨æˆ‘ä»¬éœ€è¦å¦å¤–ä¸€ä¸ªæ–‡æœ¬è¾“å…¥æ¡†ç»„ä»¶ï¼Œå®ƒä¹Ÿéœ€è¦ LocalStorage åŠ è½½ <code>'content'</code> å­—æ®µçš„æ•°æ®ã€‚æˆ‘ä»¬åªéœ€è¦å®šä¹‰ä¸€ä¸ªæ–°çš„ <code>TextareaWithContent</code>ï¼š</p>

<pre><code class="language-javascript">import wrapWithLoadData from './wrapWithLoadData'

class TextareaWithContent extends Component {
  render () {
    return &lt;textarea value={this.props.data} /&gt;
  }
}

TextareaWithContent = wrapWithLoadData(TextareaWithContent, 'content')
export default TextareaWithContent
</code></pre>

<p>å†™èµ·æ¥éå¸¸è½»æ¾ï¼Œæˆ‘ä»¬æ ¹æœ¬ä¸éœ€è¦é‡å¤å†™ä» LocalStorage åŠ è½½æ•°æ®å­—æ®µçš„é€»è¾‘ï¼Œç›´æ¥ç”¨ <code>wrapWithLoadData</code> åŒ…è£…ä¸€ä¸‹å°±å¯ä»¥äº†ã€‚</p>

<p>æˆ‘ä»¬æ¥å›é¡¾ä¸€ä¸‹åˆ°åº•å‘ç”Ÿäº†ä»€ä¹ˆäº‹æƒ…ï¼Œå¯¹äº <code>InputWithUserName</code> å’Œ <code>TextareaWithContent</code> è¿™ä¸¤ä¸ªç»„ä»¶æ¥è¯´ï¼Œå®ƒä»¬çš„éœ€æ±‚æœ‰ç€è¿™ä¹ˆä¸€ä¸ªç›¸åŒçš„é€»è¾‘ï¼šâ€œæŒ‚è½½é˜¶æ®µä» LocalStorage ä¸­åŠ è½½ç‰¹å®šå­—æ®µæ•°æ®â€ã€‚</p>

<p>å¦‚æœæŒ‰ç…§ä¹‹å‰çš„åšæ³•ï¼Œæˆ‘ä»¬éœ€è¦ç»™å®ƒä»¬ä¸¤ä¸ªéƒ½åŠ ä¸Š <code>componentWillMount</code> ç”Ÿå‘½å‘¨æœŸï¼Œç„¶ååœ¨é‡Œé¢è°ƒç”¨ LocalStorageã€‚è¦æ˜¯æœ‰ç¬¬ä¸‰ä¸ªç»„ä»¶ä¹Ÿæœ‰è¿™æ ·çš„åŠ è½½é€»è¾‘ï¼Œæˆ‘åˆå¾—å†™ä¸€éè¿™æ ·çš„é€»è¾‘ã€‚ä½†æœ‰äº† <code>wrapWithLoadData</code> é«˜é˜¶ç»„ä»¶ï¼Œæˆ‘ä»¬æŠŠè¿™æ ·çš„é€»è¾‘ç”¨ä¸€ä¸ªç»„ä»¶åŒ…è£¹äº†èµ·æ¥ï¼Œå¹¶ä¸”é€šè¿‡ç»™é«˜é˜¶ç»„ä»¶ä¼ å…¥ <code>name</code> æ¥è¾¾åˆ°ä¸åŒå­—æ®µçš„æ•°æ®åŠ è½½ã€‚å……åˆ†å¤ç”¨äº†é€»è¾‘ä»£ç ã€‚</p>

<p>åˆ°è¿™é‡Œï¼Œé«˜é˜¶ç»„ä»¶çš„ä½œç”¨å…¶å®ä¸è¨€è€Œå–»ï¼Œ<em>å…¶å®å°±æ˜¯ä¸ºäº†ç»„ä»¶ä¹‹é—´çš„ä»£ç å¤ç”¨</em>ã€‚ç»„ä»¶å¯èƒ½æœ‰ç€æŸäº›ç›¸åŒçš„é€»è¾‘ï¼ŒæŠŠè¿™äº›é€»è¾‘æŠ½ç¦»å‡ºæ¥ï¼Œæ”¾åˆ°é«˜é˜¶ç»„ä»¶ä¸­è¿›è¡Œå¤ç”¨ã€‚<em>é«˜é˜¶ç»„ä»¶å†…éƒ¨çš„åŒ…è£…ç»„ä»¶å’Œè¢«åŒ…è£…ç»„ä»¶ä¹‹é—´é€šè¿‡ <code>props</code> ä¼ é€’æ•°æ®</em>ã€‚</p>

<h2 id="é«˜é˜¶ç»„ä»¶çš„çµæ´»æ€§">é«˜é˜¶ç»„ä»¶çš„çµæ´»æ€§</h2>
<p>ä»£ç å¤ç”¨çš„æ–¹æ³•ã€å½¢å¼æœ‰å¾ˆå¤šç§ï¼Œä½ å¯ä»¥ç”¨ç±»ç»§æ‰¿æ¥åšåˆ°ä»£ç å¤ç”¨ï¼Œä¹Ÿå¯ä»¥åˆ†ç¦»æ¨¡å—çš„æ–¹å¼ã€‚ä½†æ˜¯é«˜é˜¶ç»„ä»¶è¿™ç§æ–¹å¼å¾ˆæœ‰æ„æ€ï¼Œä¹Ÿå¾ˆçµæ´»ã€‚å­¦è¿‡è®¾è®¡æ¨¡å¼çš„åŒå­¦å…¶å®åº”è¯¥èƒ½ååº”è¿‡æ¥ï¼Œå®ƒå…¶å®å°±æ˜¯è®¾è®¡æ¨¡å¼é‡Œé¢çš„è£…é¥°è€…æ¨¡å¼ã€‚å®ƒé€šè¿‡ç»„åˆçš„æ–¹å¼è¾¾åˆ°å¾ˆé«˜çš„çµæ´»ç¨‹åº¦ã€‚</p>

<p>å‡è®¾ç°åœ¨æˆ‘ä»¬éœ€æ±‚å˜åŒ–äº†ï¼Œç°åœ¨è¦çš„æ˜¯é€šè¿‡ Ajax åŠ è½½æ•°æ®è€Œä¸æ˜¯ä» LocalStorage åŠ è½½æ•°æ®ã€‚æˆ‘ä»¬åªéœ€è¦æ–°å»ºä¸€ä¸ª <code>wrapWithAjaxData</code> é«˜é˜¶ç»„ä»¶ï¼š</p>

<pre><code class="language-javascript">import React, { Component } from 'react'

export default (WrappedComponent, name) =&gt; {
  class NewComponent extends Component {
    constructor () {
      super()
      this.state = { data: null }
    }

    componentWillMount () {
      ajax.get('/data/' + name, (data) =&gt; {
        this.setState({ data })
      })
    }

    render () {
      return &lt;WrappedComponent data={this.state.data} /&gt;
    }
  }
  return NewComponent
}
</code></pre>

<p>å…¶å®å°±æ˜¯æ”¹äº†ä¸€ä¸‹ <code>wrapWithLoadData</code> çš„ <code>componentWillMount</code> ä¸­çš„é€»è¾‘ï¼Œæ”¹æˆäº†ä»æœåŠ¡å™¨åŠ è½½æ•°æ®ã€‚ç°åœ¨åªéœ€è¦æŠŠ <code>InputWithUserName</code> ç¨å¾®æ”¹ä¸€ä¸‹ï¼š</p>

<pre><code class="language-javascript">import wrapWithAjaxData from './wrapWithAjaxData'

class InputWithUserName extends Component {
  render () {
    return &lt;input value={this.props.data} /&gt;
  }
}

InputWithUserName = wrapWithAjaxData(InputWithUserName, 'username')
export default InputWithUserName
</code></pre>

<p>åªè¦æ”¹ä¸€ä¸‹åŒ…è£…çš„é«˜é˜¶ç»„ä»¶å°±å¯ä»¥è¾¾åˆ°éœ€è¦çš„æ•ˆæœã€‚è€Œä¸”æˆ‘ä»¬å¹¶æ²¡æœ‰æ”¹åŠ¨ <code>InputWithUserName</code> ç»„ä»¶å†…éƒ¨çš„ä»»ä½•é€»è¾‘ï¼Œä¹Ÿæ²¡æœ‰æ”¹åŠ¨ <code>Index</code> çš„ä»»ä½•é€»è¾‘ï¼Œåªæ˜¯æ”¹åŠ¨äº†ä¸­é—´çš„é«˜é˜¶ç»„ä»¶å‡½æ•°ã€‚</p>

<p>ï¼ˆä»¥ä¸‹å†…å®¹ä¸ºé€‰è¯»å†…å®¹ï¼Œæœ‰å…´è¶£çš„åŒå­¦å¯ä»¥ç»§ç»­å¾€ä¸‹è¯»ï¼Œå¦åˆ™ä¹Ÿå¯ä»¥ç›´æ¥è·³åˆ°æ–‡æœ«çš„æ€»ç»“éƒ¨åˆ†ã€‚ï¼‰</p>

<h2 id="å¤šå±‚é«˜é˜¶ç»„ä»¶é€‰è¯»">å¤šå±‚é«˜é˜¶ç»„ä»¶ï¼ˆé€‰è¯»ï¼‰</h2>
<p>å‡å¦‚ç°åœ¨éœ€æ±‚æœ‰å˜åŒ–äº†ï¼šæˆ‘ä»¬éœ€è¦å…ˆä» LocalStorage ä¸­åŠ è½½æ•°æ®ï¼Œå†ç”¨è¿™ä¸ªæ•°æ®å»æœåŠ¡å™¨å–æ•°æ®ã€‚æˆ‘ä»¬æ”¹ä¸€ä¸‹ï¼ˆæˆ–è€…æ–°å»ºä¸€ä¸ªï¼‰<code>wrapWithAjaxData</code> é«˜é˜¶ç»„ä»¶ï¼Œä¿®æ”¹å…¶ä¸­çš„ <code>componentWillMount</code>ï¼š</p>

<pre><code class="language-javascript">...
    componentWillMount () {
      ajax.get('/data/' + this.props.data, (data) =&gt; {
        this.setState({ data })
      })
    }
...
</code></pre>

<p>å®ƒä¼šç”¨ä¼ è¿›æ¥çš„ <code>props.data</code> å»æœåŠ¡å™¨å–æ•°æ®ã€‚è¿™æ—¶å€™ä¿®æ”¹ <code>InputWithUserName</code>ï¼š</p>

<pre><code class="language-javascript">import wrapWithLoadData from './wrapWithLoadData'
import wrapWithAjaxData from './wrapWithAjaxData'

class InputWithUserName extends Component {
  render () {
    return &lt;input value={this.props.data} /&gt;
  }
}

InputWithUserName = wrapWithAjaxData(InputWithUserName)
InputWithUserName = wrapWithLoadData(InputWithUserName, 'username')
export default InputWithUserName
</code></pre>

<p>å¤§å®¶å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬ç»™ <code>InputWithUserName</code> åº”ç”¨äº†ä¸¤ç§é«˜é˜¶ç»„ä»¶ï¼šå…ˆç”¨ <code>wrapWithAjaxData</code> åŒ…è£¹ <code>InputWithUserName</code>ï¼Œå†ç”¨ <code>wrapWithLoadData </code> åŒ…å«ä¸Šæ¬¡åŒ…è£¹çš„ç»“æœã€‚å®ƒä»¬çš„å…³ç³»å°±å¦‚ä¸‹å›¾çš„ä¸‰ä¸ªåœ†åœˆï¼š</p>

<p><a href="javascript:if(confirm('http://huzidaha.github.io/static/assets/img/posts/A8F1DD5F-1995-419E-8551-4FC2D59F58B4.png  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='http://huzidaha.github.io/static/assets/img/posts/A8F1DD5F-1995-419E-8551-4FC2D59F58B4.png'" tppabs="http://huzidaha.github.io/static/assets/img/posts/A8F1DD5F-1995-419E-8551-4FC2D59F58B4.png" target="_blank"><img src="../../../huzidaha.github.io/static/assets/img/posts/A8F1DD5F-1995-419E-8551-4FC2D59F58B4.png" tppabs="http://huzidaha.github.io/static/assets/img/posts/A8F1DD5F-1995-419E-8551-4FC2D59F58B4.png" alt="React.js å°ä¹¦å®æˆ˜é«˜é˜¶ç»„ä»¶å›¾ç‰‡" /></a></p>

<p>å®é™…ä¸Šæœ€ç»ˆå¾—åˆ°çš„ç»„ä»¶ä¼šå…ˆå» LocalStorage å–æ•°æ®ï¼Œç„¶åé€šè¿‡ <code>props.data</code> ä¼ ç»™ä¸‹ä¸€å±‚ç»„ä»¶ï¼Œä¸‹ä¸€å±‚ç”¨è¿™ä¸ª <code>props.data</code> é€šè¿‡ Ajax å»æœåŠ¡ç«¯å–æ•°æ®ï¼Œç„¶åå†é€šè¿‡ <code>props.data</code> æŠŠæ•°æ®ä¼ ç»™ä¸‹ä¸€å±‚ï¼Œä¹Ÿå°±æ˜¯ <code>InputWithUserName</code>ã€‚å¤§å®¶å¯ä»¥ä½“ä¼šä¸€ä¸‹ä¸‹å›¾å°–å¤´ä»£è¡¨çš„ç»„ä»¶ä¹‹é—´çš„æ•°æ®æµå‘ï¼š</p>

<p><a href="javascript:if(confirm('http://huzidaha.github.io/static/assets/img/posts/8F6C1E91-B365-4919-84C3-2252223621F8.png  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='http://huzidaha.github.io/static/assets/img/posts/8F6C1E91-B365-4919-84C3-2252223621F8.png'" tppabs="http://huzidaha.github.io/static/assets/img/posts/8F6C1E91-B365-4919-84C3-2252223621F8.png" target="_blank"><img src="../../../huzidaha.github.io/static/assets/img/posts/8F6C1E91-B365-4919-84C3-2252223621F8.png" tppabs="http://huzidaha.github.io/static/assets/img/posts/8F6C1E91-B365-4919-84C3-2252223621F8.png" alt="React.js å°ä¹¦å®æˆ˜é«˜é˜¶ç»„ä»¶å›¾ç‰‡" /></a></p>

<h2 id="ç”¨é«˜é˜¶ç»„ä»¶æ”¹é€ è¯„è®ºåŠŸèƒ½é€‰è¯»">ç”¨é«˜é˜¶ç»„ä»¶æ”¹é€ è¯„è®ºåŠŸèƒ½ï¼ˆé€‰è¯»ï¼‰</h2>
<p>å¤§å®¶å¯¹è¿™ç§åœ¨æŒ‚è½½é˜¶æ®µä» LocalStorage åŠ è½½æ•°æ®çš„æ¨¡å¼éƒ½å¾ˆç†Ÿæ‚‰ï¼Œåœ¨ä¸Šä¸€é˜¶æ®µçš„å®æˆ˜ä¸­ï¼Œ<code>CommentInput</code> å’Œ <code>CommentApp</code> éƒ½ç”¨äº†è¿™ç§æ–¹å¼åŠ è½½ã€ä¿å­˜æ•°æ®ã€‚å®é™…ä¸Šæˆ‘ä»¬å¯ä»¥æ„å»ºä¸€ä¸ªé«˜é˜¶ç»„ä»¶æŠŠå®ƒä»¬çš„ç›¸åŒçš„é€»è¾‘æŠ½ç¦»å‡ºæ¥ï¼Œæ„å»ºä¸€ä¸ªé«˜é˜¶ç»„ä»¶ <code>wrapWithLoadData</code>ï¼š</p>

<pre><code class="language-javascript">export default (WrappedComponent, name) =&gt; {
  class LocalStorageActions extends Component {
    constructor () {
      super()
      this.state = { data: null }
    }

    componentWillMount () {
      let data = localStorage.getItem(name)
      try {
        // å°è¯•æŠŠå®ƒè§£ææˆ JSON å¯¹è±¡
        this.setState({ data: JSON.parse(data) })
      } catch (e) {
        // å¦‚æœå‡ºé”™äº†å°±å½“æ™®é€šå­—ç¬¦ä¸²è¯»å–
        this.setState({ data })
      }
    }

    saveData (data) {
      try {
        // å°è¯•æŠŠå®ƒè§£ææˆ JSON å­—ç¬¦ä¸²
        localStorage.setItem(name, JSON.stringify(data))
      } catch (e) {
        // å¦‚æœå‡ºé”™äº†å°±å½“æ™®é€šå­—ç¬¦ä¸²ä¿å­˜
        localStorage.setItem(name, `${data}`)
      }
    }

    render () {
      return (
        &lt;WrappedComponent
          data={this.state.data}
          saveData={this.saveData.bind(this)}
          // è¿™é‡Œçš„æ„æ€æ˜¯æŠŠå…¶ä»–çš„å‚æ•°åŸå°ä¸åŠ¨åœ°ä¼ é€’ç»™è¢«åŒ…è£…çš„ç»„ä»¶
          {...this.props} /&gt;
      )
    }
  }
  return LocalStorageActions
}
</code></pre>

<p><code>CommentApp</code> å¯ä»¥è¿™æ ·ä½¿ç”¨ï¼š</p>

<pre><code class="language-javascript">class CommentApp extends Component {
  static propTypes = {
    data: PropTypes.any,
    saveData: PropTypes.func.isRequired
  }

  constructor (props) {
    super(props)
    this.state = { comments: props.data }
  }

  handleSubmitComment (comment) {
    if (!comment) return
    if (!comment.username) return alert('è¯·è¾“å…¥ç”¨æˆ·å')
    if (!comment.content) return alert('è¯·è¾“å…¥è¯„è®ºå†…å®¹')
    const comments = this.state.comments
    comments.push(comment)
    this.setState({ comments })
    this.props.saveData(comments)
  }

  handleDeleteComment (index) {
    const comments = this.state.comments
    comments.splice(index, 1)
    this.setState({ comments })
    this.props.saveData(comments)
  }

  render() {
    return (
      &lt;div className='wrapper'&gt;
        &lt;CommentInput onSubmit={this.handleSubmitComment.bind(this)} /&gt;
        &lt;CommentList
          comments={this.state.comments}
          onDeleteComment={this.handleDeleteComment.bind(this)} /&gt;
      &lt;/div&gt;
    )
  }
}

CommentApp = wrapWithLoadData(CommentApp, 'comments')
export default CommentApp
</code></pre>

<p>åŒæ ·åœ°å¯ä»¥åœ¨ <code>CommentInput</code> ä¸­ä½¿ç”¨ <code>wrapWithLoadData</code>ï¼Œè¿™é‡Œå°±ä¸è´´ä»£ç äº†ã€‚æœ‰å…´è¶£çš„åŒå­¦å¯ä»¥æŸ¥çœ‹<a href="javascript:if(confirm('https://github.com/huzidaha/react-naive-book-examples/commit/0d67eab713c042301fa4992c719069e92a7243f5  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/huzidaha/react-naive-book-examples/commit/0d67eab713c042301fa4992c719069e92a7243f5'" tppabs="https://github.com/huzidaha/react-naive-book-examples/commit/0d67eab713c042301fa4992c719069e92a7243f5">é«˜é˜¶ç»„ä»¶é‡æ„çš„ CommentApp ç‰ˆæœ¬</a>ã€‚</p>

<h2 id="æ€»ç»“">æ€»ç»“</h2>
<p><em>é«˜é˜¶ç»„ä»¶å°±æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œä¼ ç»™å®ƒä¸€ä¸ªç»„ä»¶ï¼Œå®ƒè¿”å›ä¸€ä¸ªæ–°çš„ç»„ä»¶</em>ã€‚æ–°çš„ç»„ä»¶ä½¿ç”¨ä¼ å…¥çš„ç»„ä»¶ä½œä¸ºå­ç»„ä»¶ã€‚</p>

<p><em>é«˜é˜¶ç»„ä»¶çš„ä½œç”¨æ˜¯ç”¨äºä»£ç å¤ç”¨</em>ï¼Œå¯ä»¥æŠŠç»„ä»¶ä¹‹é—´å¯å¤ç”¨çš„ä»£ç ã€é€»è¾‘æŠ½ç¦»åˆ°é«˜é˜¶ç»„ä»¶å½“ä¸­ã€‚<em>æ–°çš„ç»„ä»¶å’Œä¼ å…¥çš„ç»„ä»¶é€šè¿‡ <code>props</code> ä¼ é€’ä¿¡æ¯</em>ã€‚</p>

<p>é«˜é˜¶ç»„ä»¶æœ‰åŠ©äºæé«˜æˆ‘ä»¬ä»£ç çš„çµæ´»æ€§ï¼Œé€»è¾‘çš„å¤ç”¨æ€§ã€‚çµæ´»å’Œç†Ÿç»ƒåœ°æŒæ¡é«˜é˜¶ç»„ä»¶çš„ç”¨æ³•éœ€è¦ç»éªŒçš„ç§¯ç´¯è¿˜æœ‰é•¿æ—¶é—´çš„æ€è€ƒå’Œç»ƒä¹ ï¼Œå¦‚æœä½ è§‰å¾—æœ¬ç« èŠ‚çš„å†…å®¹æ— æ³•å®Œå…¨æ¶ˆåŒ–å’ŒæŒæ¡ä¹Ÿæ²¡æœ‰å…³ç³»ï¼Œå¯ä»¥å…ˆç®€å•äº†è§£é«˜é˜¶ç»„ä»¶çš„å®šä¹‰ã€å½¢å¼å’Œä½œç”¨å³å¯ã€‚</p>

<h2 id="è¯¾åç»ƒä¹ ">è¯¾åç»ƒä¹ </h2>
<p>*<a target="_blank" href="javascript:if(confirm('http://scriptoj.com/problems/14  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='http://scriptoj.com/problems/14'" tppabs="http://scriptoj.com/problems/14">React.js åŠ è½½ã€åˆ·æ–°æ•°æ® - é«˜é˜¶ç»„ä»¶</a></p>

<hr />

<blockquote>
  <p>å› ä¸ºç¬¬ä¸‰æ–¹è¯„è®ºå·¥å…·æœ‰é—®é¢˜ï¼Œå¯¹æœ¬ç« èŠ‚æœ‰ä»»ä½•ç–‘é—®çš„æœ‹å‹å¯ä»¥ç§»æ­¥åˆ° <a target="_blank" href="javascript:if(confirm('http://scriptoj.com/category/4/react-js-å°ä¹¦äº¤æµåŒº  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='http://scriptoj.com/category/4/react-js-å°ä¹¦äº¤æµåŒº'" tppabs="http://scriptoj.com/category/4/react-js-å°ä¹¦äº¤æµåŒº">React.js å°ä¹¦çš„è®ºå›</a> å‘å¸–ï¼Œæˆ‘ä¼šå›ç­”å¤§å®¶çš„ç–‘é—®ã€‚</p>
</blockquote>

    </div>
		<br/>
		<hr />
		<br />
		<div class="PageNavigation">
			
			<p>
				<a class="next" href="lesson29.htm" tppabs="http://huziketang.com/books/react/lesson29">ä¸‹ä¸€èŠ‚ï¼šReact.js çš„ context</a>
			</p>
			
			<br/>
			
			<p>
				<a class="prev" href="lesson27.htm" tppabs="http://huziketang.com/books/react/lesson27">ä¸Šä¸€èŠ‚ï¼šå®æˆ˜åˆ†æï¼šè¯„è®ºåŠŸèƒ½ï¼ˆå…­ï¼‰</a>
			</p>
			
		</div>
		<!-- <a class="ad" href="https://aonaotu.com" target="_blank"> -->
			<!-- <div class="ad-logo">
				<img src="/books/react/assets/img/ad-logo.svg">
				<p class="ad-title">å‡¹è„‘å›¾</p>
			</div>
			<p class="ad-wording">è¿„ä»Šä¸ºæ­¢æœ€ç®€å•å¥½ç”¨çš„åœ¨çº¿æ€ç»´å¯¼å›¾å·¥å…·</p>
			<span class="ad-indicator">å¹¿å‘Š</span>
			<img src="/books/react/assets/img/ad-bg-2.svg" class="ad-bg-2">
		</a> -->
		<!-- <div class='share-block margin-top-gap'>
			<p>å¦‚æœä½ è§‰å¾—å°ä¹¦å†™å¾—è¿˜ä¸é”™ï¼Œå¯ä»¥è¯·èƒ¡å­å¤§å“ˆå–æ¯èŒ¶ :)</p>
			<button class='donate-button' id='donate-button' type="button">èµèµ</button>
		</div> -->
		<div class='share-block margin-bottom-gap'>
			<p>ä¼ æ’­ä¸€ä¸‹çŸ¥è¯†ä¹Ÿæ˜¯ä¸€ä¸ªå¾ˆå¥½çš„é€‰æ‹©</p>
			<div class="share-block-inner">
				<div class="jiathis_style_24x24">
					<a class="jiathis_button_qzone"></a>
					<a class="jiathis_button_tsina"></a>
					<a class="jiathis_button_tqq"></a>
					<a class="jiathis_button_weixin"></a>
					<a class="jiathis_button_renren"></a>
					<a href="javascript:if(confirm('http://www.jiathis.com/share?uid=2127727  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='http://www.jiathis.com/share?uid=2127727'" tppabs="http://www.jiathis.com/share?uid=2127727" class="jiathis jiathis_txt jtico jtico_jiathis" target="_blank"></a>
				</div>
				<script type="text/javascript">
				var jiathis_config = {data_track_clickback:'true'};
				</script>
				<script type="text/javascript" src="../../../v3.jiathis.com/code/jia.js-uid=2127727" tppabs="http://v3.jiathis.com/code/jia.js?uid=2127727" charset="utf-8"></script>
			</div>
		</div>
		<!-- UY BEGIN -->
		<div id="uyan_frame"></div>
		<script type="text/javascript">
		var paths = window.location.pathname.split('/')
		var lessonName = paths[paths.length - 1]
		var uyan_config = {
			// 'url': 'http://react.huziketang.com/blog/' + lessonName,
			'du': 'http://huziketang.com/books/react/react.huziketang.com'
		}
		</script>
		<script type="text/javascript" src="../../../v2.uyan.cc/code/uyan.js-uid=2127727" tppabs="http://v2.uyan.cc/code/uyan.js?uid=2127727"></script>
		<!-- UY END -->
		<!--wechat donate-->
		<div class='donate-mask' id='donate-mask'>
			<img src="../../../huzidaha.github.io/static/assets/img/wechat-pay.png" tppabs="https://huzidaha.github.io/static/assets/img/wechat-pay.png" id='wechat-pay' />
		</div>
		<script type="text/javascript">
			// var donateMask = document.getElementById('donate-mask')
			// var donateButton = document.getElementById('donate-button')
			// var wechatPay = document.getElementById('wechat-pay')
			// donateButton.addEventListener('click', function () {
			// 	donateMask.style.display = 'flex'
			// }, false)
			// donateMask.addEventListener('click', function () {
			// 	donateMask.style.display = 'none'
			// }, false)
			// wechatPay.addEventListener('click', function (event) {
			// 	event.stopPropagation()
			// }, false)
		</script>
	</div>

    </div>
    <script src="assets/js/highlight.js" tppabs="http://huziketang.com/books/react/assets/js/highlight.js"></script>
    <script>
    var _hmt = _hmt || [];
    (function() {
      if (window.location.origin.match(/localhost/)) return
      var hm = document.createElement("script");
      hm.src = "../../../hm.baidu.com/hm.js-f08b5240ef2d1692572ce0f7756b325e"/*tpa=https://hm.baidu.com/hm.js?f08b5240ef2d1692572ce0f7756b325e*/;
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
      var bp = document.createElement('script');
      // push baidu.com
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
        bp.src = '../../../zz.bdstatic.com/linksubmit/push.js'/*tpa=https://zz.bdstatic.com/linksubmit/push.js*/;
      }
      else {
        bp.src = '../../../push.zhanzhang.baidu.com/push.js'/*tpa=http://push.zhanzhang.baidu.com/push.js*/;
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
    })();
    // var wrapper = document.getElementById('wrapper')
    // var floatWechat = document.getElementById('float-wechat')

    // function resetAll (event) {
    //   var rect = wrapper.getBoundingClientRect()
    //   resetFloatWechat(rect)
    // }
    // function resetFloatWechat(rect) {
    //   var left = rect.left + rect.width
    //   floatWechat.style.left = left + 'px'
    //   floatWechat.style.display = 'block'
    // }
    // window.addEventListener('resize', resetAll)
    // resetAll()
    </script>

</body>

</html>
